<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>1 - Running a simple simulation</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">1 - Running a simple simulation</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(landsepi)</a></code></pre></div>
<div id="general-presentation-of-the-package" class="section level2">
<h2>General presentation of the package</h2>
<p>See <code>?lansdepi</code> for a complete description of the model, assumptions and available functions. See also the vignette <a href="list_of_parameters.pdf">list of parameters</a> for a detailed description of all model parameters.<br />
Take a <a href="landsepi_poster.pdf">quick overview</a> of what landsepi can do.</p>
</div>
<div id="initialisation-of-simulation-parameters" class="section level2">
<h2>Initialisation of simulation parameters</h2>
<p>The function <code>createSimulParams()</code> will create a directory to store simulation outputs, and return an object of class <code>LandsepiParams</code> that will further contain all simulation parameters.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">createSimulParams</span>(<span class="dt">outputDir =</span> <span class="kw">getwd</span>())</a></code></pre></div>
<p>In the following, the object <code>simul_params</code> is to be updated with all simulation parameters using <code>set*()</code> functions. For some specific parameters already set using <code>set*()</code> functions, they may be next updated using <code>update*()</code> functions. To help parameterisation, built-in parameters are available and may be loaded via <code>load*()</code> functions.</p>
<p>To avoid dependency issues between functions, we recommend to parameterise the simulation with the following order (<strong>functions in bold are crucial to run a simulation</strong>, others are optional):<br />
- <strong>createSimulParams()</strong><br />
- setSeed()<br />
- <strong>setTime()</strong><br />
- setPathogen()<br />
- updateReproSexProb()<br />
- <strong>setLandscape()</strong><br />
- setDispersal()<br />
- setGenes()<br />
- <strong>setCultivars()</strong><br />
- allocateCultivarGenes()<br />
- <strong>allocateCroptypeCultivars()</strong><br />
- <strong>setCroptypes()</strong><br />
- <strong>allocateLandscapeCroptypes()</strong><br />
- setInoculum()<br />
- updateSurvivalProb()<br />
- setTreatments()<br />
- setOutputs()<br />
- checkSimulParams()<br />
- <strong>runSimul()</strong></p>
</div>
<div id="setting-the-seed-and-time-parameters" class="section level2">
<h2>Setting the seed and time parameters</h2>
<p>A seed (for random number generator) is randomly generated when <code>simul_params</code> is initialised by <code>createSimulParams()</code>. If a specific seed is required, it can be set using the function <code>setSeed()</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">simul_params<span class="op">@</span>Seed</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; [1] 1725356389</span></a>
<a class="sourceLine" id="cb3-3" title="3">simul_params &lt;-<span class="st"> </span><span class="kw">setSeed</span>(simul_params, <span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">simul_params<span class="op">@</span>Seed</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>The number of cropping seasons to simulate (e.g. 6 years) and the number of time steps per cropping season (e.g. 120 days/year) can be set using <code>setTime()</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">setTime</span>(simul_params, <span class="dt">Nyears =</span> <span class="dv">6</span>, <span class="dt">nTSpY =</span> <span class="dv">120</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">simul_params<span class="op">@</span>TimeParam</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; $Nyears</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; [1] 6</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; $nTSpY</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; [1] 120</span></a></code></pre></div>
</div>
<div id="setting-pathogen-parameters" class="section level2">
<h2>Setting pathogen parameters</h2>
<p>Pathogen parameters must be stored in a list of aggressiveness components defined on a susceptible host for a pathogen genotype not adapted to resistance.</p>
<p>Buit-in parameterisation for different pathogens (e.g. rusts of cereal crops, mildew of grapevine, black sigatoka of banana) are available using function <code>loadPathogen()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">basic_patho_param &lt;-<span class="st"> </span><span class="kw">loadPathogen</span>(<span class="dt">disease =</span> <span class="st">&quot;rust&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">basic_patho_param</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; $name</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; [1] &quot;rust&quot;</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; [1] 1e-04</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-39" title="39"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-42" title="42"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb5-43" title="43"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-45" title="45"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb5-46" title="46"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-47" title="47">basic_patho_param &lt;-<span class="st"> </span><span class="kw">loadPathogen</span>(<span class="dt">disease =</span> <span class="st">&quot;mildew&quot;</span>)</a>
<a class="sourceLine" id="cb5-48" title="48">basic_patho_param</a>
<a class="sourceLine" id="cb5-49" title="49"><span class="co">#&gt; $name</span></a>
<a class="sourceLine" id="cb5-50" title="50"><span class="co">#&gt; [1] &quot;mildew&quot;</span></a>
<a class="sourceLine" id="cb5-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-52" title="52"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb5-53" title="53"><span class="co">#&gt; [1] 1e-04</span></a>
<a class="sourceLine" id="cb5-54" title="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-55" title="55"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb5-56" title="56"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-58" title="58"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb5-59" title="59"><span class="co">#&gt; [1] 0.9</span></a>
<a class="sourceLine" id="cb5-60" title="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-61" title="61"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb5-62" title="62"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb5-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-64" title="64"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb5-65" title="65"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb5-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-67" title="67"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb5-68" title="68"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb5-69" title="69"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-70" title="70"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb5-71" title="71"><span class="co">#&gt; [1] 14</span></a>
<a class="sourceLine" id="cb5-72" title="72"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-73" title="73"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb5-74" title="74"><span class="co">#&gt; [1] 22</span></a>
<a class="sourceLine" id="cb5-75" title="75"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-76" title="76"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb5-77" title="77"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb5-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-79" title="79"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb5-80" title="80"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb5-81" title="81"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-82" title="82"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb5-83" title="83"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-84" title="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-85" title="85"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb5-86" title="86"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb5-87" title="87"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-88" title="88"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb5-89" title="89"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-90" title="90"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-91" title="91"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb5-92" title="92"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-93" title="93">basic_patho_param &lt;-<span class="st"> </span><span class="kw">loadPathogen</span>(<span class="dt">disease =</span> <span class="st">&quot;sigatoka&quot;</span>)</a>
<a class="sourceLine" id="cb5-94" title="94">basic_patho_param</a>
<a class="sourceLine" id="cb5-95" title="95"><span class="co">#&gt; $name</span></a>
<a class="sourceLine" id="cb5-96" title="96"><span class="co">#&gt; [1] &quot;sigatoka&quot;</span></a>
<a class="sourceLine" id="cb5-97" title="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-98" title="98"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb5-99" title="99"><span class="co">#&gt; [1] 0.5</span></a>
<a class="sourceLine" id="cb5-100" title="100"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-101" title="101"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb5-102" title="102"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-103" title="103"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-104" title="104"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb5-105" title="105"><span class="co">#&gt; [1] 0.02</span></a>
<a class="sourceLine" id="cb5-106" title="106"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-107" title="107"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb5-108" title="108"><span class="co">#&gt; [1] 90.9</span></a>
<a class="sourceLine" id="cb5-109" title="109"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-110" title="110"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb5-111" title="111"><span class="co">#&gt; [1] 25.5</span></a>
<a class="sourceLine" id="cb5-112" title="112"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-113" title="113"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb5-114" title="114"><span class="co">#&gt; [1] 1.5</span></a>
<a class="sourceLine" id="cb5-115" title="115"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-116" title="116"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb5-117" title="117"><span class="co">#&gt; [1] 22</span></a>
<a class="sourceLine" id="cb5-118" title="118"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-119" title="119"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb5-120" title="120"><span class="co">#&gt; [1] 14</span></a>
<a class="sourceLine" id="cb5-121" title="121"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-122" title="122"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb5-123" title="123"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb5-124" title="124"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-125" title="125"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb5-126" title="126"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb5-127" title="127"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-128" title="128"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb5-129" title="129"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-130" title="130"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-131" title="131"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb5-132" title="132"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-133" title="133"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-134" title="134"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb5-135" title="135"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-136" title="136"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-137" title="137"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb5-138" title="138"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<p>This list may be updated to change a specific parameter. For instance, to change the infection rate to 50%:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">basic_patho_param &lt;-<span class="st"> </span><span class="kw">loadPathogen</span>(<span class="st">&quot;rust&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">basic_patho_param<span class="op">$</span>infection_rate &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb6-3" title="3">basic_patho_param</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; $name</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; [1] &quot;rust&quot;</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; [1] 1e-04</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; [1] 0.5</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-25" title="25"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb6-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb6-41" title="41"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb6-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-43" title="43"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb6-44" title="44"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb6-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-46" title="46"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb6-47" title="47"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<p>Alternatively, the list may be generated manually to control all parameters:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">basic_patho_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">infection_rate =</span> <span class="fl">0.4</span></a>
<a class="sourceLine" id="cb7-2" title="2">                          , <span class="dt">latent_period_mean =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb7-3" title="3">                          , <span class="dt">latent_period_var =</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb7-4" title="4">                          , <span class="dt">propagule_prod_rate =</span> <span class="fl">3.125</span></a>
<a class="sourceLine" id="cb7-5" title="5">                          , <span class="dt">infectious_period_mean =</span> <span class="dv">24</span></a>
<a class="sourceLine" id="cb7-6" title="6">                          , <span class="dt">infectious_period_var =</span> <span class="dv">105</span></a>
<a class="sourceLine" id="cb7-7" title="7">                          , <span class="dt">survival_prob =</span> <span class="fl">1e-4</span></a>
<a class="sourceLine" id="cb7-8" title="8">                          , <span class="dt">repro_sex_prob =</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb7-9" title="9">                          , <span class="dt">sigmoid_kappa =</span> <span class="fl">5.333</span></a>
<a class="sourceLine" id="cb7-10" title="10">                          , <span class="dt">sigmoid_sigma =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb7-11" title="11">                          , <span class="dt">sigmoid_plateau =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb7-12" title="12">                          , <span class="dt">sex_propagule_viability_limit =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb7-13" title="13">                          , <span class="dt">sex_propagule_release_mean =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb7-14" title="14">                          , <span class="dt">clonal_propagule_gradual_release =</span> <span class="dv">0</span>)</a></code></pre></div>
<p>Then, the list is used to fuel the object <code>simul_params</code> via the function <code>setPathogen()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">setPathogen</span>(simul_params, <span class="dt">patho_params =</span> basic_patho_param)</a>
<a class="sourceLine" id="cb8-2" title="2">simul_params<span class="op">@</span>Pathogen</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; [1] 1e-04</span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb8-28" title="28"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-30" title="30"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-33" title="33"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb8-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-36" title="36"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb8-37" title="37"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb8-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-39" title="39"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb8-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-42" title="42"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb8-43" title="43"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
</div>
<div id="setting-the-landscape-and-pathogen-dispersal" class="section level2">
<h2>Setting the landscape and pathogen dispersal</h2>
<p>The landscape (i.e. boundaries of fields) must be in shapefile format. Five built-in landscapes of about 150 fields are available using the function <code>loadLandscape()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">landscape &lt;-<span class="st"> </span><span class="kw">loadLandscape</span>(<span class="dt">id =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">length</span>(landscape)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; [1] 155</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">plot</span>(landscape, <span class="dt">main =</span> <span class="st">&quot;Landscape structure&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" alt="The first Landscape available" /></p>
<p><em>See also tutorial on how to <a href="O3-landscape_dispersal.html">parameterise landscape and dispersal</a> to use your own landscape and compute your own dispersal matrices.</em></p>
<p>Dispersal is given by a vectorised matrix giving the probability of dispersal from any field of the landscape to any other field. The size of the matrix must be the square of the number of fields in the landscape. It is thus specific to both the pathogen and the landscape. For rusts pathogens, a built-in dispersal matrix is available for each landscape using the function <code>loadDispersalPathogen()</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">disp_patho_clonal &lt;-<span class="st"> </span><span class="kw">loadDispersalPathogen</span>(<span class="dt">id =</span> <span class="dv">1</span>)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">head</span>(disp_patho_clonal)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; [1] 8.814254e-01 9.525884e-04 7.079895e-10 1.594379e-10 3.285800e-06</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; [6] 3.634297e-11</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw">length</span>(landscape)<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="kw">length</span>(disp_patho_clonal)</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Then, the object <code>simul_params</code> is updated with the landscape and dispersal matrix via the functions <code>setLandscape()</code> and <code>setDispersalPathogen()</code>, respectively:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">setLandscape</span>(simul_params, <span class="dt">land =</span> landscape)</a>
<a class="sourceLine" id="cb11-2" title="2">simul_params &lt;-<span class="st"> </span><span class="kw">setDispersalPathogen</span>(simul_params, disp_patho_clonal)</a></code></pre></div>
</div>
<div id="setting-croptypes-cultivars-and-resistance-genes" class="section level2">
<h2>Setting croptypes, cultivars and resistance genes</h2>
<p>Fields of the landscape are cultivated with different croptypes that can rotate through time; each croptype is composed of a pure cultivar or a mixture; and each cultivar may carry one or several resistance genes.</p>
<div id="cultivars" class="section level3">
<h3>Cultivars</h3>
<p>Characteristics of each host genotype (i.e. cultivar) are summarised in a dataframe, which contains parameters representing the cultivar as if it was cultivated in a pure crop. <strong>Note that the name of the cultivar cannot accept spaces.</strong><br />
A buit-in parameterisation for classical types of cultivars is available using <code>loadCultivar()</code> to generate each line of the dataframe. Type “nonCrop” allows the simulation of forest, fallows, etc. i.e. everything that is not planted, does not cost anything and does not yield anything (with regard to the subject of the study).<br />
<strong>It is advised to implement a susceptible cultivar at first line of the dataframe to allow pathogen initial inoculation in default parameterisation.</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">cultivar1 &lt;-<span class="st"> </span><span class="kw">loadCultivar</span>(<span class="dt">name =</span> <span class="st">&quot;Susceptible&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;wheat&quot;</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">cultivar2 &lt;-<span class="st"> </span><span class="kw">loadCultivar</span>(<span class="dt">name =</span> <span class="st">&quot;Resistant1&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;wheat&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">cultivar3 &lt;-<span class="st"> </span><span class="kw">loadCultivar</span>(<span class="dt">name =</span> <span class="st">&quot;Resistant2&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb12-4" title="4">cultivar4 &lt;-<span class="st"> </span><span class="kw">loadCultivar</span>(<span class="dt">name =</span> <span class="st">&quot;Resistant3&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;pepper&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">cultivar5 &lt;-<span class="st"> </span><span class="kw">loadCultivar</span>(<span class="dt">name =</span> <span class="st">&quot;Forest&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;nonCrop&quot;</span>)</a>
<a class="sourceLine" id="cb12-6" title="6">cultivars &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(cultivar1, cultivar2, cultivar3, cultivar4, cultivar5)</a>
<a class="sourceLine" id="cb12-7" title="7">                        , <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-8" title="8">cultivars</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt;   cultivarName initial_density max_density growth_rate reproduction_rate</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt; 1  Susceptible            0.10        2.00        0.10                 0</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt; 2   Resistant1            0.10        2.00        0.10                 0</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt; 3   Resistant2            0.90        1.80        0.02                 0</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt; 4   Resistant3            1.75        1.75        0.00                 0</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt; 5       Forest            0.00        2.00        0.00                 0</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt;   yield_H yield_L yield_I yield_R planting_cost market_value</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt; 1     2.5     0.0       0       0           225          200</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">#&gt; 2     2.5     0.0       0       0           225          200</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co">#&gt; 3    46.8    46.8       0       0             0            0</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="co">#&gt; 4     0.5     0.5       0       0             0            0</span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="co">#&gt; 5     0.0     0.0       0       0             0            0</span></a></code></pre></div>
<p>Similarly as pathogen parameters, characteristics of the cultivars may be updated as required. For example, to change the growth rate of the susceptible cultivar:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">cultivars[cultivars<span class="op">$</span>cultivarName <span class="op">==</span><span class="st"> &quot;Susceptible&quot;</span>, <span class="st">&quot;growth_rate&quot;</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb13-2" title="2">cultivars</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#&gt;   cultivarName initial_density max_density growth_rate reproduction_rate</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; 1  Susceptible            0.10        2.00        0.20                 0</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#&gt; 2   Resistant1            0.10        2.00        0.10                 0</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">#&gt; 3   Resistant2            0.90        1.80        0.02                 0</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt; 4   Resistant3            1.75        1.75        0.00                 0</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt; 5       Forest            0.00        2.00        0.00                 0</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">#&gt;   yield_H yield_L yield_I yield_R planting_cost market_value</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">#&gt; 1     2.5     0.0       0       0           225          200</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">#&gt; 2     2.5     0.0       0       0           225          200</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">#&gt; 3    46.8    46.8       0       0             0            0</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">#&gt; 4     0.5     0.5       0       0             0            0</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">#&gt; 5     0.0     0.0       0       0             0            0</span></a></code></pre></div>
<p>Finally, the dataframe <code>cultivars</code> can also be generated entirely from scratch:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">cultivars_new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">cultivarName =</span> <span class="kw">c</span>(<span class="st">&quot;Susceptible&quot;</span>, <span class="st">&quot;Resistant&quot;</span>),</a>
<a class="sourceLine" id="cb14-2" title="2">                            <span class="dt">initial_density =</span>   <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb14-3" title="3">                            <span class="dt">max_density =</span>       <span class="kw">c</span>(<span class="fl">2.0</span>, <span class="fl">3.0</span>),</a>
<a class="sourceLine" id="cb14-4" title="4">                            <span class="dt">growth_rate =</span>       <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb14-5" title="5">                            <span class="dt">reproduction_rate =</span> <span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>),</a>
<a class="sourceLine" id="cb14-6" title="6">                            <span class="dt">yield_H =</span>           <span class="kw">c</span>(<span class="fl">2.5</span>, <span class="fl">2.0</span>),</a>
<a class="sourceLine" id="cb14-7" title="7">                            <span class="dt">yield_L =</span>           <span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>),</a>
<a class="sourceLine" id="cb14-8" title="8">                            <span class="dt">yield_I =</span>           <span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>),</a>
<a class="sourceLine" id="cb14-9" title="9">                            <span class="dt">yield_R =</span>           <span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>),</a>
<a class="sourceLine" id="cb14-10" title="10">                            <span class="dt">planting_cost =</span>   <span class="kw">c</span>(<span class="dv">225</span>, <span class="dv">300</span>),</a>
<a class="sourceLine" id="cb14-11" title="11">                            <span class="dt">market_value =</span>      <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">150</span>),</a>
<a class="sourceLine" id="cb14-12" title="12">                            <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-13" title="13">cultivars_new</a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co">#&gt;   cultivarName initial_density max_density growth_rate reproduction_rate</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt; 1  Susceptible             0.1           2         0.1                 0</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt; 2    Resistant             0.2           3         0.2                 0</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt;   yield_H yield_L yield_I yield_R planting_cost market_value</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">#&gt; 1     2.5       0       0       0           225          200</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="co">#&gt; 2     2.0       0       0       0           300          150</span></a></code></pre></div>
<p>Note, assuming that only healthy hosts (state H) contribute to host growth, the production of healthy biomass between <span class="math inline">\(t\)</span> and <span class="math inline">\(t+1\)</span> is computed using the following logistic equation: <span class="math display">\[H_{t+1} = H_{t} \times  \left[1 + growth\_rate \times (1-\frac{N_{t}}{K})\right]\]</span> with <span class="math inline">\(N_t\)</span> the total number of individual hosts at time-step <span class="math inline">\(t\)</span> and <span class="math inline">\(K\)</span> the carrying capacity.</p>
</div>
<div id="resistance-genes" class="section level3">
<h3>Resistance genes</h3>
<p>This part can be skipped if no resistance gene is to be simulated. Characteristics of each plant resistance gene and each corresponding pathogenicity gene are summarised in a dataframe.<br />
A built-in parameterisation for classical resistance sources is available using <code>loadGene()</code> to generate each line of the dataframe. Type “majorGene” is for completely efficient resistance to which pathogen may adapt via a single mutation.<br />
Type “APR” stands for Adult Plant Resistance, i.e. a major gene which activates after a delay after planting, and type “QTL” is a partially efficient resistance source to which the pathogen may adapt gradually. The type “immunity” code for a completely efficient resistance gene that cannot be overcome, in such a way that infection is totally impossible; it is helpful to parameterise non-host cultivars.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">gene1 &lt;-<span class="st"> </span><span class="kw">loadGene</span>(<span class="dt">name =</span> <span class="st">&quot;MG 1&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;majorGene&quot;</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">gene2 &lt;-<span class="st"> </span><span class="kw">loadGene</span>(<span class="dt">name =</span> <span class="st">&quot;Lr34&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;APR&quot;</span>)</a>
<a class="sourceLine" id="cb15-3" title="3">gene3 &lt;-<span class="st"> </span><span class="kw">loadGene</span>(<span class="dt">name =</span> <span class="st">&quot;gene 3&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;QTL&quot;</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">gene4 &lt;-<span class="st"> </span><span class="kw">loadGene</span>(<span class="dt">name =</span> <span class="st">&quot;nonhost resistance&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;immunity&quot;</span>)</a>
<a class="sourceLine" id="cb15-5" title="5">genes &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(gene1, gene2, gene3, gene4), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-6" title="6">genes</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#&gt;             geneName efficiency age_of_activ_mean age_of_activ_var</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&gt; 1               MG 1        1.0                 0                0</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt; 2               Lr34        1.0                30               30</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt; 3             gene 3        0.5                 0                0</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#&gt; 4 nonhost resistance        1.0                 0                0</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#&gt;   mutation_prob Nlevels_aggressiveness adaptation_cost relative_advantage</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt; 1         1e-07                      2             0.5                0.5</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">#&gt; 2         1e-07                      2             0.5                0.5</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">#&gt; 3         1e-04                      6             0.5                0.5</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#&gt; 4         0e+00                      1             0.0                0.0</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#&gt;   tradeoff_strength target_trait recombination_sd</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">#&gt; 1                 1           IR             1.00</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">#&gt; 2                 1           IR             1.00</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">#&gt; 3                 1           IR             0.27</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">#&gt; 4                 1           IR             1.00</span></a></code></pre></div>
<p>Similarly as pathogen parameters, characteristics of the genes may be updated as required. For example, to change the mutation probability of the pathogen with regard to its adaptation to “MG 1”:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">genes[genes<span class="op">$</span>geneName <span class="op">==</span><span class="st"> &quot;MG 1&quot;</span>, <span class="st">&quot;mutation_prob&quot;</span>] &lt;-<span class="st"> </span><span class="fl">1e-3</span></a>
<a class="sourceLine" id="cb16-2" title="2">genes</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt;             geneName efficiency age_of_activ_mean age_of_activ_var</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt; 1               MG 1        1.0                 0                0</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#&gt; 2               Lr34        1.0                30               30</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt; 3             gene 3        0.5                 0                0</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#&gt; 4 nonhost resistance        1.0                 0                0</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#&gt;   mutation_prob Nlevels_aggressiveness adaptation_cost relative_advantage</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt; 1         1e-03                      2             0.5                0.5</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#&gt; 2         1e-07                      2             0.5                0.5</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">#&gt; 3         1e-04                      6             0.5                0.5</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; 4         0e+00                      1             0.0                0.0</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt;   tradeoff_strength target_trait recombination_sd</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">#&gt; 1                 1           IR             1.00</span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#&gt; 2                 1           IR             1.00</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">#&gt; 3                 1           IR             0.27</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#&gt; 4                 1           IR             1.00</span></a></code></pre></div>
<p>Alternatively, the dataframe <code>genes</code> can also be generated entirely from scratch:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">genes_new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">geneName =</span>               <span class="kw">c</span>(<span class="st">&quot;MG1&quot;</span>, <span class="st">&quot;MG2&quot;</span>),</a>
<a class="sourceLine" id="cb17-2" title="2">                        <span class="dt">efficiency =</span>             <span class="kw">c</span>(<span class="fl">1.0</span>  , <span class="fl">0.8</span>  ),</a>
<a class="sourceLine" id="cb17-3" title="3">                        <span class="dt">age_of_activ_mean =</span>      <span class="kw">c</span>(<span class="fl">0.0</span>  , <span class="fl">0.0</span>  ),</a>
<a class="sourceLine" id="cb17-4" title="4">                        <span class="dt">age_of_activ_var =</span>       <span class="kw">c</span>(<span class="fl">0.0</span>  , <span class="fl">0.0</span>  ),</a>
<a class="sourceLine" id="cb17-5" title="5">                        <span class="dt">mutation_prob =</span>          <span class="kw">c</span>(<span class="fl">1E-7</span> , <span class="fl">1E-4</span>),</a>
<a class="sourceLine" id="cb17-6" title="6">                        <span class="dt">Nlevels_aggressiveness =</span> <span class="kw">c</span>(<span class="dv">2</span>    , <span class="dv">2</span>    ),</a>
<a class="sourceLine" id="cb17-7" title="7">                        <span class="dt">adaptation_cost =</span>        <span class="kw">c</span>(<span class="fl">0.50</span> , <span class="fl">0.75</span> ),</a>
<a class="sourceLine" id="cb17-8" title="8">                        <span class="dt">relative_advantage =</span>     <span class="kw">c</span>(<span class="fl">0.50</span> , <span class="fl">0.75</span> ),</a>
<a class="sourceLine" id="cb17-9" title="9">                        <span class="dt">tradeoff_strength =</span>      <span class="kw">c</span>(<span class="fl">1.0</span>  , <span class="fl">1.0</span>  ),</a>
<a class="sourceLine" id="cb17-10" title="10">                        <span class="dt">target_trait =</span>           <span class="kw">c</span>(<span class="st">&quot;IR&quot;</span> , <span class="st">&quot;LAT&quot;</span>),</a>
<a class="sourceLine" id="cb17-11" title="11">                        <span class="dt">recombination_sd =</span>       <span class="kw">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>),</a>
<a class="sourceLine" id="cb17-12" title="12">                        <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-13" title="13">genes_new</a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">#&gt;   geneName efficiency age_of_activ_mean age_of_activ_var mutation_prob</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">#&gt; 1      MG1        1.0                 0                0         1e-07</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">#&gt; 2      MG2        0.8                 0                0         1e-04</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">#&gt;   Nlevels_aggressiveness adaptation_cost relative_advantage tradeoff_strength</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">#&gt; 1                      2            0.50               0.50                 1</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">#&gt; 2                      2            0.75               0.75                 1</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">#&gt;   target_trait recombination_sd</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co">#&gt; 1           IR                1</span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="co">#&gt; 2          LAT                1</span></a></code></pre></div>
<p>Note that the column “efficiency” refers to the percentage of reduction of the targeted aggressiveness component on hosts carrying the gene. For example, a 80% efficient resistance against infection rate (target_trait = “IR”) means that the infection rate of a non-adapted pathogen is reduced by 80% on a resistant host compared to what it is on a susceptible host. For resistances targeting the latent period, the percentage of reduction is applied to the inverse of the latent period in such a way that latent period is higher in resistant than in susceptible hosts.</p>
</div>
<div id="allocating-genes-to-cultivars" class="section level3">
<h3>Allocating genes to cultivars</h3>
<p>The object <code>simul_params</code> can be updated with <code>setGenes()</code> and <code>setCultivars()</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">setGenes</span>(simul_params, <span class="dt">dfGenes =</span> genes)</a>
<a class="sourceLine" id="cb18-2" title="2">simul_params &lt;-<span class="st"> </span><span class="kw">setCultivars</span>(simul_params, <span class="dt">dfCultivars =</span> cultivars)</a>
<a class="sourceLine" id="cb18-3" title="3">simul_params<span class="op">@</span>Genes</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#&gt;                              geneName efficiency age_of_activ_mean</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#&gt; MG 1                             MG 1        1.0                 0</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#&gt; Lr34                             Lr34        1.0                30</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; gene 3                         gene 3        0.5                 0</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt; nonhost resistance nonhost resistance        1.0                 0</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt;                    age_of_activ_var mutation_prob Nlevels_aggressiveness</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt; MG 1                              0         1e-03                      2</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt; Lr34                             30         1e-07                      2</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt; gene 3                            0         1e-04                      6</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt; nonhost resistance                0         0e+00                      1</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt;                    adaptation_cost relative_advantage tradeoff_strength</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt; MG 1                           0.5                0.5                 1</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt; Lr34                           0.5                0.5                 1</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt; gene 3                         0.5                0.5                 1</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt; nonhost resistance             0.0                0.0                 1</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt;                    target_trait recombination_sd</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#&gt; MG 1                         IR             1.00</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="co">#&gt; Lr34                         IR             1.00</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co">#&gt; gene 3                       IR             0.27</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co">#&gt; nonhost resistance           IR             1.00</span></a>
<a class="sourceLine" id="cb18-24" title="24">simul_params<span class="op">@</span>Cultivars</a>
<a class="sourceLine" id="cb18-25" title="25"><span class="co">#&gt;             cultivarName initial_density max_density growth_rate</span></a>
<a class="sourceLine" id="cb18-26" title="26"><span class="co">#&gt; Susceptible  Susceptible            0.10        2.00        0.20</span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="co">#&gt; Resistant1    Resistant1            0.10        2.00        0.10</span></a>
<a class="sourceLine" id="cb18-28" title="28"><span class="co">#&gt; Resistant2    Resistant2            0.90        1.80        0.02</span></a>
<a class="sourceLine" id="cb18-29" title="29"><span class="co">#&gt; Resistant3    Resistant3            1.75        1.75        0.00</span></a>
<a class="sourceLine" id="cb18-30" title="30"><span class="co">#&gt; Forest            Forest            0.00        2.00        0.00</span></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="co">#&gt;             reproduction_rate yield_H yield_L yield_I yield_R planting_cost</span></a>
<a class="sourceLine" id="cb18-32" title="32"><span class="co">#&gt; Susceptible                 0     2.5     0.0       0       0           225</span></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="co">#&gt; Resistant1                  0     2.5     0.0       0       0           225</span></a>
<a class="sourceLine" id="cb18-34" title="34"><span class="co">#&gt; Resistant2                  0    46.8    46.8       0       0             0</span></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="co">#&gt; Resistant3                  0     0.5     0.5       0       0             0</span></a>
<a class="sourceLine" id="cb18-36" title="36"><span class="co">#&gt; Forest                      0     0.0     0.0       0       0             0</span></a>
<a class="sourceLine" id="cb18-37" title="37"><span class="co">#&gt;             market_value</span></a>
<a class="sourceLine" id="cb18-38" title="38"><span class="co">#&gt; Susceptible          200</span></a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co">#&gt; Resistant1           200</span></a>
<a class="sourceLine" id="cb18-40" title="40"><span class="co">#&gt; Resistant2             0</span></a>
<a class="sourceLine" id="cb18-41" title="41"><span class="co">#&gt; Resistant3             0</span></a>
<a class="sourceLine" id="cb18-42" title="42"><span class="co">#&gt; Forest                 0</span></a></code></pre></div>
<p>Then the function <code>allocateCultivarGenes()</code> allows the attribution of resistance genes to cultivars:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">allocateCultivarGenes</span>(simul_params</a>
<a class="sourceLine" id="cb19-2" title="2">                                      , <span class="dt">cultivarName =</span> <span class="st">&quot;Resistant1&quot;</span></a>
<a class="sourceLine" id="cb19-3" title="3">                                      , <span class="dt">listGenesNames =</span> <span class="kw">c</span>(<span class="st">&quot;MG 1&quot;</span>))</a>
<a class="sourceLine" id="cb19-4" title="4">simul_params &lt;-<span class="st"> </span><span class="kw">allocateCultivarGenes</span>(simul_params</a>
<a class="sourceLine" id="cb19-5" title="5">                                      , <span class="dt">cultivarName =</span> <span class="st">&quot;Resistant2&quot;</span></a>
<a class="sourceLine" id="cb19-6" title="6">                                      , <span class="dt">listGenesNames =</span> <span class="kw">c</span>(<span class="st">&quot;Lr34&quot;</span>, <span class="st">&quot;gene 3&quot;</span>))</a>
<a class="sourceLine" id="cb19-7" title="7">simul_params &lt;-<span class="st"> </span><span class="kw">allocateCultivarGenes</span>(simul_params</a>
<a class="sourceLine" id="cb19-8" title="8">                                      , <span class="dt">cultivarName =</span> <span class="st">&quot;Resistant3&quot;</span></a>
<a class="sourceLine" id="cb19-9" title="9">                                      , <span class="dt">listGenesNames =</span> <span class="kw">c</span>(<span class="st">&quot;nonhost resistance&quot;</span>))</a>
<a class="sourceLine" id="cb19-10" title="10">simul_params<span class="op">@</span>CultivarsGenes</a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">#&gt;             MG 1 Lr34 gene 3 nonhost resistance</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">#&gt; Susceptible    0    0      0                  0</span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">#&gt; Resistant1     1    0      0                  0</span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co">#&gt; Resistant2     0    1      1                  0</span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co">#&gt; Resistant3     0    0      0                  1</span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co">#&gt; Forest         0    0      0                  0</span></a></code></pre></div>
<p>With this example of parameterisation:<br />
- “Susceptible” is a susceptible cultivar (initially infected by a wild-type pathogen)<br />
- “Resistant1” is a mono-resistant cultivar<br />
- “Resistant2” is a pyramided cultivar<br />
- “Resistant3” is a nonhost cultivar<br />
- “Forest” is not a crop.<br />
Infection is impossible on both “Resistance3” and “Forest”, but the former will be considered for host growth, yield and planting costs, whereas the latter won’t.</p>
</div>
<div id="allocating-cultivars-to-croptypes" class="section level3">
<h3>Allocating cultivars to croptypes</h3>
<p>Characteristics of each croptype (a croptype is a set of hosts cultivated in a field with specific proportions) are summarised in a dataframe.<br />
A buit-in parameterisation for classical croptypes is available using <code>loadCroptypes()</code> to generate the whole table filled with zeros:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">croptypes &lt;-<span class="st"> </span><span class="kw">loadCroptypes</span>(simul_params, <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;Susceptible crop&quot;</span></a>
<a class="sourceLine" id="cb20-2" title="2">                                                   , <span class="st">&quot;Pure resistant crop&quot;</span></a>
<a class="sourceLine" id="cb20-3" title="3">                                                   , <span class="st">&quot;Mixture&quot;</span></a>
<a class="sourceLine" id="cb20-4" title="4">                                                   , <span class="st">&quot;Other&quot;</span>))</a>
<a class="sourceLine" id="cb20-5" title="5">croptypes</a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co">#&gt;   croptypeID        croptypeName Susceptible Resistant1 Resistant2 Resistant3</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#&gt; 1          0    Susceptible crop           0          0          0          0</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co">#&gt; 2          1 Pure resistant crop           0          0          0          0</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#&gt; 3          2             Mixture           0          0          0          0</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#&gt; 4          3               Other           0          0          0          0</span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co">#&gt;   Forest</span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="co">#&gt; 1      0</span></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="co">#&gt; 2      0</span></a>
<a class="sourceLine" id="cb20-14" title="14"><span class="co">#&gt; 3      0</span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co">#&gt; 4      0</span></a></code></pre></div>
<p>Then <code>croptypes</code> is updated by <code>allocateCroptypeCultivars()</code> to specify the composition of every croptype with regard to cultivars (and proportion for mixtures):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">croptypes &lt;-<span class="st"> </span><span class="kw">allocateCroptypeCultivars</span>(croptypes</a>
<a class="sourceLine" id="cb21-2" title="2">                                       , <span class="dt">croptypeName =</span> <span class="st">&quot;Susceptible crop&quot;</span></a>
<a class="sourceLine" id="cb21-3" title="3">                                       , <span class="dt">cultivarsInCroptype =</span> <span class="st">&quot;Susceptible&quot;</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">croptypes &lt;-<span class="st"> </span><span class="kw">allocateCroptypeCultivars</span>(croptypes</a>
<a class="sourceLine" id="cb21-5" title="5">                                       , <span class="dt">croptypeName =</span> <span class="st">&quot;Pure resistant crop&quot;</span></a>
<a class="sourceLine" id="cb21-6" title="6">                                       , <span class="dt">cultivarsInCroptype =</span> <span class="st">&quot;Resistant1&quot;</span>)</a>
<a class="sourceLine" id="cb21-7" title="7">croptypes &lt;-<span class="st"> </span><span class="kw">allocateCroptypeCultivars</span>(croptypes</a>
<a class="sourceLine" id="cb21-8" title="8">                                       , <span class="dt">croptypeName =</span> <span class="st">&quot;Mixture&quot;</span></a>
<a class="sourceLine" id="cb21-9" title="9">                                       , <span class="dt">cultivarsInCroptype =</span> <span class="kw">c</span>(<span class="st">&quot;Resistant2&quot;</span>,<span class="st">&quot;Resistant3&quot;</span>)</a>
<a class="sourceLine" id="cb21-10" title="10">                                       , <span class="dt">prop =</span> <span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</a>
<a class="sourceLine" id="cb21-11" title="11">croptypes &lt;-<span class="st"> </span><span class="kw">allocateCroptypeCultivars</span>(croptypes</a>
<a class="sourceLine" id="cb21-12" title="12">                                       , <span class="dt">croptypeName =</span> <span class="st">&quot;Other&quot;</span></a>
<a class="sourceLine" id="cb21-13" title="13">                                       , <span class="dt">cultivarsInCroptype =</span> <span class="st">&quot;Forest&quot;</span>)</a>
<a class="sourceLine" id="cb21-14" title="14">croptypes</a>
<a class="sourceLine" id="cb21-15" title="15"><span class="co">#&gt;   croptypeID        croptypeName Susceptible Resistant1 Resistant2 Resistant3</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="co">#&gt; 1          0    Susceptible crop           1          0        0.0        0.0</span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="co">#&gt; 2          1 Pure resistant crop           0          1        0.0        0.0</span></a>
<a class="sourceLine" id="cb21-18" title="18"><span class="co">#&gt; 3          2             Mixture           0          0        0.4        0.6</span></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="co">#&gt; 4          3               Other           0          0        0.0        0.0</span></a>
<a class="sourceLine" id="cb21-20" title="20"><span class="co">#&gt;   Forest</span></a>
<a class="sourceLine" id="cb21-21" title="21"><span class="co">#&gt; 1      0</span></a>
<a class="sourceLine" id="cb21-22" title="22"><span class="co">#&gt; 2      0</span></a>
<a class="sourceLine" id="cb21-23" title="23"><span class="co">#&gt; 3      0</span></a>
<a class="sourceLine" id="cb21-24" title="24"><span class="co">#&gt; 4      1</span></a></code></pre></div>
<p>Finally the object <code>simul_params</code> is updated using <code>setCroptypes()</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">setCroptypes</span>(simul_params, <span class="dt">dfCroptypes =</span> croptypes)</a>
<a class="sourceLine" id="cb22-2" title="2">simul_params<span class="op">@</span>Croptypes</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#&gt;   croptypeID        croptypeName Susceptible Resistant1 Resistant2 Resistant3</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#&gt; 0          0    Susceptible crop           1          0        0.0        0.0</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">#&gt; 1          1 Pure resistant crop           0          1        0.0        0.0</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">#&gt; 2          2             Mixture           0          0        0.4        0.6</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">#&gt; 3          3               Other           0          0        0.0        0.0</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">#&gt;   Forest</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">#&gt; 0      0</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">#&gt; 1      0</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#&gt; 2      0</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co">#&gt; 3      1</span></a></code></pre></div>
<p>Alternatively, the dataframe <code>croptypes</code> can be generated from scratch:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">croptypes &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">croptypeID =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="co">## must start at 0 and match with values from landscape &quot;croptypeID&quot; layer</span></a>
<a class="sourceLine" id="cb23-2" title="2">                        , <span class="dt">croptypeName =</span> <span class="kw">c</span>(<span class="st">&quot;Susceptible crop&quot;</span></a>
<a class="sourceLine" id="cb23-3" title="3">                                           , <span class="st">&quot;Pure resistant crop&quot;</span></a>
<a class="sourceLine" id="cb23-4" title="4">                                           , <span class="st">&quot;Mixture&quot;</span></a>
<a class="sourceLine" id="cb23-5" title="5">                                           , <span class="st">&quot;Other&quot;</span>)</a>
<a class="sourceLine" id="cb23-6" title="6">                        , <span class="dt">Susceptible =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>  ,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb23-7" title="7">                        , <span class="dt">Resistant1  =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>  ,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb23-8" title="8">                        , <span class="dt">Resistant2  =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb23-9" title="9">                        , <span class="dt">Resistant3  =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb23-10" title="10">                        , <span class="dt">Forest      =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>  ,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb23-11" title="11">                        , <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb23-12" title="12">simul_params &lt;-<span class="st"> </span><span class="kw">setCroptypes</span>(simul_params, croptypes)</a></code></pre></div>
</div>
<div id="allocating-croptypes-to-fields-of-the-landscape" class="section level3">
<h3>Allocating croptypes to fields of the landscape</h3>
<p>The function <code>allocateLandscapeCroptypes()</code> manages the allocation of croptypes in time (for rotations of different croptypes on the same fields) and space (for mosaic of fields cultivated with different croptypes). See <code>?allocateLandscapeCroptypes</code> for help in parameters.<br />
Briefly, a rotation sequence is defined by a list. Each element of this list is a vector containing the indices of the croptypes that are cultivated simultaneously in the landscape. The “rotation_period” parameter defines the duration before switching from one element of “rotation_sequence” to the next. For each element of “rotation_sequence” is associated a vector of proportions of each croptype in the landscape (parameter “prop”). The parameter “aggreg” controls the level of spatial aggregation between croptypes.</p>
<p>For example, to generate a landscape whose surface is composed of 1/3 of forests, 1/3 of susceptible crop, and 1/3 of fields where a pure resistant crop is alternated with a mixture every two years:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># croptypeIDs cultivated in each element of the rotation sequence:</span></a>
<a class="sourceLine" id="cb24-2" title="2">rotation_sequence &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb24-3" title="3">rotation_period &lt;-<span class="st"> </span><span class="dv">2</span>  <span class="co"># number of years before rotation of the landscape</span></a>
<a class="sourceLine" id="cb24-4" title="4">prop &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="co"># proportion (in surface) of each croptype </span></a>
<a class="sourceLine" id="cb24-5" title="5">aggreg &lt;-<span class="dv">1</span> <span class="co"># level of spatial aggregation</span></a>
<a class="sourceLine" id="cb24-6" title="6">simul_params &lt;-<span class="st"> </span><span class="kw">allocateLandscapeCroptypes</span>(simul_params</a>
<a class="sourceLine" id="cb24-7" title="7">                                           , <span class="dt">rotation_period =</span> rotation_period</a>
<a class="sourceLine" id="cb24-8" title="8">                                           , <span class="dt">rotation_sequence =</span> rotation_sequence</a>
<a class="sourceLine" id="cb24-9" title="9">                                           , <span class="dt">prop =</span> prop</a>
<a class="sourceLine" id="cb24-10" title="10">                                           , <span class="dt">aggreg =</span> aggreg</a>
<a class="sourceLine" id="cb24-11" title="11">                                           , <span class="dt">graphic =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co"># plot(simul_params@Landscape)</span></a></code></pre></div>
</div>
</div>
<div id="setting-the-inoculum" class="section level2">
<h2>Setting the inoculum</h2>
<p>To set the inoculum, the function <code>setInoculum()</code> is used. Several scenarios may be simulated and are summarized below. For the default scenario (see below), the function is simply parameterised with the probability for individual hosts to be infectious (i.e. at state ‘I’) at the beginning of the simulation (i.e. at t=0).</p>
<p>For more complex scenarios (i.e. to specify the location and genetic structure of the inoculum), the function <code>setInoculum()</code> can be used with a 3D-array of dimensions (Nhost, Npatho, Npoly) indicating the initial probability to be infectious, for each cultivar, pathogen genotype and polygon, respectively. To define this array, the functions <code>getMatrixGenePatho()</code>, <code>getMatrixCultivarPatho()</code>, <code>getMatrixCroptypePatho()</code> and <code>getMatrixPolyPatho()</code> acknowledge which pathogen genotypes can infect which genes, cultivars, croptypes and polygons respectively. Each function returns a matrix indicating if there is compatibility (value of 1, i.e. infection is possible) or not (value of 0, i.e. the cultivar is not present, or protected by a fully efficient resistance gene targeting the infection rate from the beginning of the cropping season).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">getMatrixGenePatho</span>(simul_params)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co">#&gt;                    [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">#&gt; MG 1                  0    0    0    0    0    0    0    0    0     0     0</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">#&gt; Lr34                  1    1    1    1    1    1    1    1    1     1     1</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#&gt; gene 3                1    1    1    1    1    1    1    1    1     1     1</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co">#&gt; nonhost resistance    0    0    0    0    0    0    0    0    0     0     0</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">#&gt;                    [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co">#&gt; MG 1                   0     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co">#&gt; Lr34                   1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">#&gt; gene 3                 1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="co">#&gt; nonhost resistance     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co">#&gt;                    [,22] [,23] [,24]</span></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="co">#&gt; MG 1                   1     1     1</span></a>
<a class="sourceLine" id="cb25-14" title="14"><span class="co">#&gt; Lr34                   1     1     1</span></a>
<a class="sourceLine" id="cb25-15" title="15"><span class="co">#&gt; gene 3                 1     1     1</span></a>
<a class="sourceLine" id="cb25-16" title="16"><span class="co">#&gt; nonhost resistance     0     0     0</span></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="kw">getMatrixCultivarPatho</span>(simul_params)</a>
<a class="sourceLine" id="cb25-18" title="18"><span class="co">#&gt;             [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="co">#&gt; Susceptible    1    1    1    1    1    1    1    1    1     1     1     1</span></a>
<a class="sourceLine" id="cb25-20" title="20"><span class="co">#&gt; Resistant1     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb25-21" title="21"><span class="co">#&gt; Resistant2     1    1    1    1    1    1    1    1    1     1     1     1</span></a>
<a class="sourceLine" id="cb25-22" title="22"><span class="co">#&gt; Resistant3     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb25-23" title="23"><span class="co">#&gt; Forest         0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb25-24" title="24"><span class="co">#&gt;             [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span></a>
<a class="sourceLine" id="cb25-25" title="25"><span class="co">#&gt; Susceptible     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-26" title="26"><span class="co">#&gt; Resistant1      1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-27" title="27"><span class="co">#&gt; Resistant2      1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-28" title="28"><span class="co">#&gt; Resistant3      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-29" title="29"><span class="co">#&gt; Forest          0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-30" title="30"><span class="co">#&gt;             [,24]</span></a>
<a class="sourceLine" id="cb25-31" title="31"><span class="co">#&gt; Susceptible     1</span></a>
<a class="sourceLine" id="cb25-32" title="32"><span class="co">#&gt; Resistant1      1</span></a>
<a class="sourceLine" id="cb25-33" title="33"><span class="co">#&gt; Resistant2      1</span></a>
<a class="sourceLine" id="cb25-34" title="34"><span class="co">#&gt; Resistant3      0</span></a>
<a class="sourceLine" id="cb25-35" title="35"><span class="co">#&gt; Forest          0</span></a>
<a class="sourceLine" id="cb25-36" title="36"><span class="kw">getMatrixCroptypePatho</span>(simul_params)</a>
<a class="sourceLine" id="cb25-37" title="37"><span class="co">#&gt;                     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]</span></a>
<a class="sourceLine" id="cb25-38" title="38"><span class="co">#&gt; Susceptible crop       1    1    1    1    1    1    1    1    1     1     1</span></a>
<a class="sourceLine" id="cb25-39" title="39"><span class="co">#&gt; Pure resistant crop    0    0    0    0    0    0    0    0    0     0     0</span></a>
<a class="sourceLine" id="cb25-40" title="40"><span class="co">#&gt; Mixture                1    1    1    1    1    1    1    1    1     1     1</span></a>
<a class="sourceLine" id="cb25-41" title="41"><span class="co">#&gt; Other                  0    0    0    0    0    0    0    0    0     0     0</span></a>
<a class="sourceLine" id="cb25-42" title="42"><span class="co">#&gt;                     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]</span></a>
<a class="sourceLine" id="cb25-43" title="43"><span class="co">#&gt; Susceptible crop        1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-44" title="44"><span class="co">#&gt; Pure resistant crop     0     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-45" title="45"><span class="co">#&gt; Mixture                 1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-46" title="46"><span class="co">#&gt; Other                   0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-47" title="47"><span class="co">#&gt;                     [,22] [,23] [,24]</span></a>
<a class="sourceLine" id="cb25-48" title="48"><span class="co">#&gt; Susceptible crop        1     1     1</span></a>
<a class="sourceLine" id="cb25-49" title="49"><span class="co">#&gt; Pure resistant crop     1     1     1</span></a>
<a class="sourceLine" id="cb25-50" title="50"><span class="co">#&gt; Mixture                 1     1     1</span></a>
<a class="sourceLine" id="cb25-51" title="51"><span class="co">#&gt; Other                   0     0     0</span></a>
<a class="sourceLine" id="cb25-52" title="52"><span class="kw">getMatrixPolyPatho</span>(simul_params)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a>
<a class="sourceLine" id="cb25-53" title="53"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span></a>
<a class="sourceLine" id="cb25-54" title="54"><span class="co">#&gt;  [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-55" title="55"><span class="co">#&gt;  [2,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-56" title="56"><span class="co">#&gt;  [3,]    1    1    1    1    1    1    1    1    1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-57" title="57"><span class="co">#&gt;  [4,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span></a>
<a class="sourceLine" id="cb25-58" title="58"><span class="co">#&gt;  [5,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span></a>
<a class="sourceLine" id="cb25-59" title="59"><span class="co">#&gt;  [6,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span></a>
<a class="sourceLine" id="cb25-60" title="60"><span class="co">#&gt;  [7,]    1    1    1    1    1    1    1    1    1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-61" title="61"><span class="co">#&gt;  [8,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span></a>
<a class="sourceLine" id="cb25-62" title="62"><span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span></a>
<a class="sourceLine" id="cb25-63" title="63"><span class="co">#&gt; [10,]    1    1    1    1    1    1    1    1    1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-64" title="64"><span class="co">#&gt;       [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]</span></a>
<a class="sourceLine" id="cb25-65" title="65"><span class="co">#&gt;  [1,]     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-66" title="66"><span class="co">#&gt;  [2,]     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb25-67" title="67"><span class="co">#&gt;  [3,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-68" title="68"><span class="co">#&gt;  [4,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-69" title="69"><span class="co">#&gt;  [5,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-70" title="70"><span class="co">#&gt;  [6,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-71" title="71"><span class="co">#&gt;  [7,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-72" title="72"><span class="co">#&gt;  [8,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-73" title="73"><span class="co">#&gt;  [9,]     1     1     1     1     1     1     1     1     1     1     1</span></a>
<a class="sourceLine" id="cb25-74" title="74"><span class="co">#&gt; [10,]     1     1     1     1     1     1     1     1     1     1     1</span></a></code></pre></div>
<p>Finally, the function <code>loadInoculum()</code> helps build the inoculum array as follows:<br />
Let <span class="math inline">\(\phi_{v,p,i}\)</span> be the probability for an individual of cultivar <span class="math inline">\(v\)</span> to be infected by pathogen genotype <span class="math inline">\(p\)</span> in field <span class="math inline">\(i\)</span> at the beginning of the simulation. This probability is computed as follows: <span class="math display">\[\phi_{v, p, i} = \phi^0 \times \phi^{host}_{v} \times \phi^{patho}_{p} \times \phi^{poly}_{i} \times I^{present}_{v,i} \times I^{compatible}_{v,p}\]</span> with:<br />
<span class="math inline">\(\phi^{host}\)</span> the vector of probabilities for every host (parameter <code>pI0_host</code>),<br />
<span class="math inline">\(\phi^{patho}\)</span> the vector of probabilities for every pathogen genotype (parameter <code>pI0_patho</code>),<br />
<span class="math inline">\(\phi^{poly}\)</span> the vector of probabilities for every polygon (parameter <code>pI0_poly</code>),<br />
<span class="math inline">\(\phi^0\)</span> a multiplicative constant (parameter <code>pI0_all</code>).<br />
<span class="math inline">\(I^{present}_{v,i}\)</span> a binary variable equal to 1 if cultivar <span class="math inline">\(v\)</span> is grown in field <span class="math inline">\(i\)</span> (and 0 otherwise),<br />
<span class="math inline">\(I^{compatible}_{v,p}\)</span> a binary variable equal to 1 if pathogen genotype <span class="math inline">\(p\)</span> can infect cultivar <span class="math inline">\(v\)</span> at the beginning of the cropping season (and 0 otherwise).</p>
<div id="scenario-1-default.-only-the-avirulent-pathogen-on-the-susceptible-cultivar-in-all-fields-global-inoculum" class="section level3">
<h3>Scenario 1 (default). Only the avirulent pathogen on the susceptible cultivar in all fields (global inoculum)</h3>
<p>The default scenario is the presence of a pathogen genotype not adapted to any resistance gene, and present in all fields of the landscape where a susceptible cultivar is grown. In this situation, it is important that the susceptible cultivar is entered at the first line of the table cultivars. Then, one can simply use:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># Option 1: simply use the default parameterisation</span></a>
<a class="sourceLine" id="cb26-2" title="2">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, <span class="fl">5E-4</span>)</a>
<a class="sourceLine" id="cb26-3" title="3"> </a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co"># Option 2: use loadInoculum()</span></a>
<a class="sourceLine" id="cb26-5" title="5">Npatho &lt;-<span class="st"> </span><span class="kw">prod</span>(simul_params<span class="op">@</span>Genes<span class="op">$</span>Nlevels_aggressiveness)</a>
<a class="sourceLine" id="cb26-6" title="6">Nhost &lt;-<span class="st"> </span><span class="kw">nrow</span>(simul_params<span class="op">@</span>Cultivars)</a>
<a class="sourceLine" id="cb26-7" title="7">pI0 &lt;-<span class="st"> </span><span class="kw">loadInoculum</span>(simul_params, <span class="dt">pI0_all=</span><span class="fl">5E-4</span>, <span class="dt">pI0_host=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>, Nhost<span class="dv">-1</span>)), <span class="dt">pI0_patho=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>, Npatho<span class="dv">-1</span>)))</a>
<a class="sourceLine" id="cb26-8" title="8">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, pI0)</a></code></pre></div>
</div>
<div id="scenario-2.-only-the-avirulent-pathogen-on-the-susceptible-cultivar-in-only-some-fields-local-inoculum" class="section level3">
<h3>Scenario 2. Only the avirulent pathogen on the susceptible cultivar in only some fields (local inoculum)</h3>
<p>To specify the location of the inoculum, the parameters <code>pI0_host</code>, <code>pI0_patho</code> and <code>pI0_poly</code> are filled with values of 1 and 0 indicating if the cultivar, pathogen genotype and field are inoculated or not. The probability is given by the constant <code>pI0_all</code>. In this example, 5 fields in the landscape are randomly chosen among those cultivated with the susceptible cultivar:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">Npatho &lt;-<span class="st"> </span><span class="kw">prod</span>(simul_params<span class="op">@</span>Genes<span class="op">$</span>Nlevels_aggressiveness)  <span class="co">## Nb of pathogen genotypes</span></a>
<a class="sourceLine" id="cb27-2" title="2">Nhost &lt;-<span class="st"> </span><span class="kw">nrow</span>(simul_params<span class="op">@</span>Cultivars)  <span class="co">## Nb of cultivars</span></a>
<a class="sourceLine" id="cb27-3" title="3">Npoly &lt;-<span class="st"> </span><span class="kw">nrow</span>(simul_params<span class="op">@</span>Landscape)  <span class="co">## Nb of polygons in the landscape</span></a>
<a class="sourceLine" id="cb27-4" title="4">Npoly_inoc &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co">## number of inoculated polygons</span></a>
<a class="sourceLine" id="cb27-5" title="5">compatible_poly &lt;-<span class="st"> </span><span class="kw">getMatrixPolyPatho</span>(simul_params)[,<span class="dv">1</span>]  <span class="co">## whether the avr pathogen can infect the polygons</span></a>
<a class="sourceLine" id="cb27-6" title="6">id_poly &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">grep</span>(<span class="dv">1</span>, compatible_poly), Npoly_inoc)  <span class="co">## random polygon picked among compatible ones</span></a>
<a class="sourceLine" id="cb27-7" title="7">pI0_poly &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="dv">1</span><span class="op">:</span>Npoly <span class="op">%in%</span><span class="st"> </span>id_poly)  </a>
<a class="sourceLine" id="cb27-8" title="8">pI0 &lt;-<span class="st"> </span><span class="kw">loadInoculum</span>(simul_params, <span class="dt">pI0_all=</span><span class="fl">5E-4</span>, <span class="dt">pI0_host=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>, Nhost<span class="dv">-1</span>)), <span class="dt">pI0_patho=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>, Npatho<span class="dv">-1</span>)), </a>
<a class="sourceLine" id="cb27-9" title="9">                    <span class="dt">pI0_poly=</span>pI0_poly)</a>
<a class="sourceLine" id="cb27-10" title="10">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, pI0)</a></code></pre></div>
</div>
<div id="scenario-3.-a-diversity-of-pathogen-genotypes-in-the-inoculum-in-all-fields-global-inoculum" class="section level3">
<h3>Scenario 3. A diversity of pathogen genotypes in the inoculum, in all fields (global inoculum)</h3>
<p>This scenario matches with situations where several pathogen genotypes (including those adapted to resistance) are initially present in the landscape at the beginning of the simulation. In this example, different probabilities are given to the different pathogen genotypes using the parameters <code>pI0_patho</code> (the same rationale can be used for different probabilities on the different hosts using <code>pI0_host</code>).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">## Example with 4 pathogen genotypes and 2 cultivars</span></a>
<a class="sourceLine" id="cb28-2" title="2">pI0 &lt;-<span class="st"> </span><span class="kw">loadInoculum</span>(simul_params, <span class="dt">pI0_patho=</span><span class="kw">c</span>(<span class="fl">1E-3</span>,<span class="fl">1E-4</span>,<span class="fl">1E-4</span>,<span class="fl">1E-5</span>), <span class="dt">pI0_host=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb28-3" title="3">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, pI0)</a></code></pre></div>
</div>
<div id="scenario-4.-a-diversity-of-pathogen-genotypes-in-the-inoculum-in-some-fields-only-local-inoculum" class="section level3">
<h3>Scenario 4. A diversity of pathogen genotypes in the inoculum, in some fields only (local inoculum)</h3>
<p>Here, the example is similar as the previous one but only 5 fields are inoculated:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">Npoly &lt;-<span class="st"> </span><span class="kw">nrow</span>(simul_params<span class="op">@</span>Landscape)</a>
<a class="sourceLine" id="cb29-2" title="2">Npoly_inoc &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co">## number of inoculated polygons </span></a>
<a class="sourceLine" id="cb29-3" title="3">id_poly &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>Npoly, Npoly_inoc)  <span class="co">## random polygon </span></a>
<a class="sourceLine" id="cb29-4" title="4">pI0_poly &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="dv">1</span><span class="op">:</span>Npoly <span class="op">%in%</span><span class="st"> </span>id_poly) </a>
<a class="sourceLine" id="cb29-5" title="5">pI0 &lt;-<span class="st"> </span><span class="kw">loadInoculum</span>(simul_params, <span class="dt">pI0_patho=</span><span class="kw">c</span>(<span class="fl">1E-3</span>,<span class="fl">1E-4</span>,<span class="fl">1E-4</span>,<span class="fl">1E-5</span>), <span class="dt">pI0_host=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">pI0_poly=</span>pI0_poly)</a>
<a class="sourceLine" id="cb29-6" title="6">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, pI0)</a></code></pre></div>
</div>
<div id="scenario-5.-custom-3d-array-to-define-the-inoculum" class="section level3">
<h3>Scenario 5. Custom 3D array to define the inoculum</h3>
<p>At last, if one wants to run a simulation with a custom inoculum on the whole landscape, it can simply be entered in the function <code>setInoculum()</code> as an array of dimension (Nhost, Npatho, Npoly). Note that in this situation, host individuals may be infected regardless the resistance gene they carry.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co">## example with 2 cultivars, 4 pathogen genotypes and 5 fields</span></a>
<a class="sourceLine" id="cb30-2" title="2">Nhost=<span class="dv">2</span></a>
<a class="sourceLine" id="cb30-3" title="3">Npatho=<span class="dv">4</span></a>
<a class="sourceLine" id="cb30-4" title="4">Npoly=<span class="dv">5</span></a>
<a class="sourceLine" id="cb30-5" title="5">pI0 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">40</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>, <span class="dt">dim =</span> <span class="kw">c</span>(Nhost, Npatho, Npoly))</a>
<a class="sourceLine" id="cb30-6" title="6">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, pI0)</a></code></pre></div>
<p>To generate an array that accounts for the fact that (i) the cultivars are not grown in all polygons, and (ii) cultivars may carry a resistance gene that prevent initial infection by some pathogen genotypes, one can use the function <code>loadInoculum()</code> as follows:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">corrected_pI0 &lt;-<span class="st"> </span><span class="kw">loadInoculum</span>(simul_params, <span class="dt">pI0_mat=</span>pI0)</a>
<a class="sourceLine" id="cb31-2" title="2">simul_params &lt;-<span class="st"> </span><span class="kw">setInoculum</span>(simul_params, corrected_pI0)</a></code></pre></div>
</div>
<div id="visualization" class="section level3">
<h3>Visualization</h3>
<p>The 3D-array inoculum can be vizualised using the function <code>inoculumToMatrix()</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">inoculumToMatrix</span>(simul_params)[,,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="co">#&gt;             [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="co">#&gt; Susceptible    0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co">#&gt; Resistant1     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co">#&gt; Resistant2     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="co">#&gt; Resistant3     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="co">#&gt; Forest         0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-10" title="10"><span class="co">#&gt;             [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span></a>
<a class="sourceLine" id="cb32-11" title="11"><span class="co">#&gt; Susceptible     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-12" title="12"><span class="co">#&gt; Resistant1      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-13" title="13"><span class="co">#&gt; Resistant2      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-14" title="14"><span class="co">#&gt; Resistant3      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-15" title="15"><span class="co">#&gt; Forest          0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-16" title="16"><span class="co">#&gt;             [,24]</span></a>
<a class="sourceLine" id="cb32-17" title="17"><span class="co">#&gt; Susceptible     0</span></a>
<a class="sourceLine" id="cb32-18" title="18"><span class="co">#&gt; Resistant1      0</span></a>
<a class="sourceLine" id="cb32-19" title="19"><span class="co">#&gt; Resistant2      0</span></a>
<a class="sourceLine" id="cb32-20" title="20"><span class="co">#&gt; Resistant3      0</span></a>
<a class="sourceLine" id="cb32-21" title="21"><span class="co">#&gt; Forest          0</span></a>
<a class="sourceLine" id="cb32-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-23" title="23"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb32-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-25" title="25"><span class="co">#&gt;             [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb32-26" title="26"><span class="co">#&gt; Susceptible    0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-27" title="27"><span class="co">#&gt; Resistant1     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-28" title="28"><span class="co">#&gt; Resistant2     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-29" title="29"><span class="co">#&gt; Resistant3     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-30" title="30"><span class="co">#&gt; Forest         0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-31" title="31"><span class="co">#&gt;             [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span></a>
<a class="sourceLine" id="cb32-32" title="32"><span class="co">#&gt; Susceptible     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-33" title="33"><span class="co">#&gt; Resistant1      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-34" title="34"><span class="co">#&gt; Resistant2      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-35" title="35"><span class="co">#&gt; Resistant3      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-36" title="36"><span class="co">#&gt; Forest          0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-37" title="37"><span class="co">#&gt;             [,24]</span></a>
<a class="sourceLine" id="cb32-38" title="38"><span class="co">#&gt; Susceptible     0</span></a>
<a class="sourceLine" id="cb32-39" title="39"><span class="co">#&gt; Resistant1      0</span></a>
<a class="sourceLine" id="cb32-40" title="40"><span class="co">#&gt; Resistant2      0</span></a>
<a class="sourceLine" id="cb32-41" title="41"><span class="co">#&gt; Resistant3      0</span></a>
<a class="sourceLine" id="cb32-42" title="42"><span class="co">#&gt; Forest          0</span></a>
<a class="sourceLine" id="cb32-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-44" title="44"><span class="co">#&gt; , , 3</span></a>
<a class="sourceLine" id="cb32-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-46" title="46"><span class="co">#&gt;              [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb32-47" title="47"><span class="co">#&gt; Susceptible 5e-04    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-48" title="48"><span class="co">#&gt; Resistant1  0e+00    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-49" title="49"><span class="co">#&gt; Resistant2  0e+00    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-50" title="50"><span class="co">#&gt; Resistant3  0e+00    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-51" title="51"><span class="co">#&gt; Forest      0e+00    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-52" title="52"><span class="co">#&gt;             [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span></a>
<a class="sourceLine" id="cb32-53" title="53"><span class="co">#&gt; Susceptible     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-54" title="54"><span class="co">#&gt; Resistant1      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-55" title="55"><span class="co">#&gt; Resistant2      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-56" title="56"><span class="co">#&gt; Resistant3      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-57" title="57"><span class="co">#&gt; Forest          0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-58" title="58"><span class="co">#&gt;             [,24]</span></a>
<a class="sourceLine" id="cb32-59" title="59"><span class="co">#&gt; Susceptible     0</span></a>
<a class="sourceLine" id="cb32-60" title="60"><span class="co">#&gt; Resistant1      0</span></a>
<a class="sourceLine" id="cb32-61" title="61"><span class="co">#&gt; Resistant2      0</span></a>
<a class="sourceLine" id="cb32-62" title="62"><span class="co">#&gt; Resistant3      0</span></a>
<a class="sourceLine" id="cb32-63" title="63"><span class="co">#&gt; Forest          0</span></a>
<a class="sourceLine" id="cb32-64" title="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-65" title="65"><span class="co">#&gt; , , 4</span></a>
<a class="sourceLine" id="cb32-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-67" title="67"><span class="co">#&gt;             [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb32-68" title="68"><span class="co">#&gt; Susceptible    0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-69" title="69"><span class="co">#&gt; Resistant1     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-70" title="70"><span class="co">#&gt; Resistant2     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-71" title="71"><span class="co">#&gt; Resistant3     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-72" title="72"><span class="co">#&gt; Forest         0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-73" title="73"><span class="co">#&gt;             [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span></a>
<a class="sourceLine" id="cb32-74" title="74"><span class="co">#&gt; Susceptible     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-75" title="75"><span class="co">#&gt; Resistant1      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-76" title="76"><span class="co">#&gt; Resistant2      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-77" title="77"><span class="co">#&gt; Resistant3      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-78" title="78"><span class="co">#&gt; Forest          0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-79" title="79"><span class="co">#&gt;             [,24]</span></a>
<a class="sourceLine" id="cb32-80" title="80"><span class="co">#&gt; Susceptible     0</span></a>
<a class="sourceLine" id="cb32-81" title="81"><span class="co">#&gt; Resistant1      0</span></a>
<a class="sourceLine" id="cb32-82" title="82"><span class="co">#&gt; Resistant2      0</span></a>
<a class="sourceLine" id="cb32-83" title="83"><span class="co">#&gt; Resistant3      0</span></a>
<a class="sourceLine" id="cb32-84" title="84"><span class="co">#&gt; Forest          0</span></a>
<a class="sourceLine" id="cb32-85" title="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-86" title="86"><span class="co">#&gt; , , 5</span></a>
<a class="sourceLine" id="cb32-87" title="87"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-88" title="88"><span class="co">#&gt;             [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></a>
<a class="sourceLine" id="cb32-89" title="89"><span class="co">#&gt; Susceptible    0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-90" title="90"><span class="co">#&gt; Resistant1     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-91" title="91"><span class="co">#&gt; Resistant2     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-92" title="92"><span class="co">#&gt; Resistant3     0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-93" title="93"><span class="co">#&gt; Forest         0    0    0    0    0    0    0    0    0     0     0     0</span></a>
<a class="sourceLine" id="cb32-94" title="94"><span class="co">#&gt;             [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span></a>
<a class="sourceLine" id="cb32-95" title="95"><span class="co">#&gt; Susceptible     0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-96" title="96"><span class="co">#&gt; Resistant1      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-97" title="97"><span class="co">#&gt; Resistant2      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-98" title="98"><span class="co">#&gt; Resistant3      0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-99" title="99"><span class="co">#&gt; Forest          0     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb32-100" title="100"><span class="co">#&gt;             [,24]</span></a>
<a class="sourceLine" id="cb32-101" title="101"><span class="co">#&gt; Susceptible     0</span></a>
<a class="sourceLine" id="cb32-102" title="102"><span class="co">#&gt; Resistant1      0</span></a>
<a class="sourceLine" id="cb32-103" title="103"><span class="co">#&gt; Resistant2      0</span></a>
<a class="sourceLine" id="cb32-104" title="104"><span class="co">#&gt; Resistant3      0</span></a>
<a class="sourceLine" id="cb32-105" title="105"><span class="co">#&gt; Forest          0</span></a></code></pre></div>
</div>
</div>
<div id="updating-the-survival-probability-during-the-off-season" class="section level2">
<h2>Updating the survival probability during the off-season</h2>
<p>At the end of each cropping season, pathogens experience a bottleneck representing the off-season. The probability for a pathogen propagule to survive the off-season depends on the capacity of the “green bridge” to host the pathogen. This green bridge can, for example, be a wild reservoir or volunteer plants remaining in the field (e.g. owing to seedlings or incomplete harvest). It is assumed that the probability of survival is the same every year and in every polygon, but this assumption can be relaxed by updating the probability with a matrix indicating a probability for every croptype and every year. This simulates different management strategies or agronomic practices during the off-season. The function <code>updateSurvivalProb()</code> creates this matrix as follows:</p>
<p>Let <span class="math inline">\(\lambda_{y,c}\)</span> be the probability for a pathogen propagule to survive the off-season between year <span class="math inline">\(y\)</span> and year <span class="math inline">\(y+1\)</span> in a polygon cultivated with croptype <span class="math inline">\(c\)</span>. Unless the matrix is directly entered via the parameter <code>mat</code>, it is computed by <span class="math inline">\(\lambda_{y,c} = \lambda_{y} \times \lambda_{c}\)</span> with:<br />
<span class="math inline">\(\lambda_{y}\)</span> the vector of probabilities for every year (parameter <code>mat_year</code>),<br />
<span class="math inline">\(\lambda_{c}\)</span> the vector of probabilities for every croptype (parameter <code>mat_croptype</code>).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">Ncroptypes &lt;-<span class="st"> </span><span class="kw">nrow</span>(simul_params<span class="op">@</span>Croptypes)</a>
<a class="sourceLine" id="cb33-2" title="2">Nyears &lt;-<span class="st"> </span>simul_params<span class="op">@</span>TimeParam<span class="op">$</span>Nyears</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co">## Same probability in every croptype:</span></a>
<a class="sourceLine" id="cb33-4" title="4">simul_params &lt;-<span class="st"> </span><span class="kw">updateSurvivalProb</span>(simul_params, <span class="dt">mat_year=</span><span class="dv">1</span><span class="op">:</span>Nyears<span class="op">/</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb33-5" title="5">simul_params<span class="op">@</span>Pathogen</a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb33-10" title="10"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb33-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-21" title="21"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb33-22" title="22"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb33-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-24" title="24"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb33-25" title="25"><span class="co">#&gt;  [1] 0.01 0.02 0.03 0.04 0.05 0.06 0.01 0.02 0.03 0.04 0.05 0.06 0.01 0.02 0.03</span></a>
<a class="sourceLine" id="cb33-26" title="26"><span class="co">#&gt; [16] 0.04 0.05 0.06 0.01 0.02 0.03 0.04 0.05 0.06</span></a>
<a class="sourceLine" id="cb33-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-28" title="28"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb33-29" title="29"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-30" title="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-31" title="31"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb33-32" title="32"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb33-33" title="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-34" title="34"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb33-35" title="35"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb33-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-37" title="37"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb33-38" title="38"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-40" title="40"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb33-41" title="41"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-43" title="43"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb33-44" title="44"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-46" title="46"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb33-47" title="47"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-48" title="48"><span class="co">## Same probability every year:</span></a>
<a class="sourceLine" id="cb33-49" title="49">simul_params &lt;-<span class="st"> </span><span class="kw">updateSurvivalProb</span>(simul_params, <span class="dt">mat_croptype=</span><span class="dv">1</span><span class="op">:</span>Ncroptypes<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb33-50" title="50">simul_params<span class="op">@</span>Pathogen</a>
<a class="sourceLine" id="cb33-51" title="51"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb33-52" title="52"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb33-53" title="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-54" title="54"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb33-55" title="55"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb33-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-57" title="57"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb33-58" title="58"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb33-59" title="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-60" title="60"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb33-61" title="61"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb33-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-63" title="63"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb33-64" title="64"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb33-65" title="65"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-66" title="66"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb33-67" title="67"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb33-68" title="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-69" title="69"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb33-70" title="70"><span class="co">#&gt;  [1] 0.1 0.1 0.1 0.1 0.1 0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.3 0.3 0.3 0.3 0.3 0.3 0.4</span></a>
<a class="sourceLine" id="cb33-71" title="71"><span class="co">#&gt; [20] 0.4 0.4 0.4 0.4 0.4</span></a>
<a class="sourceLine" id="cb33-72" title="72"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-73" title="73"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb33-74" title="74"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-75" title="75"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-76" title="76"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb33-77" title="77"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb33-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-79" title="79"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb33-80" title="80"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb33-81" title="81"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-82" title="82"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb33-83" title="83"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-84" title="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-85" title="85"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb33-86" title="86"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-87" title="87"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-88" title="88"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb33-89" title="89"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-90" title="90"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-91" title="91"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb33-92" title="92"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-93" title="93"><span class="co">## specific probability for different croptypes and years:</span></a>
<a class="sourceLine" id="cb33-94" title="94">simul_params &lt;-<span class="st"> </span><span class="kw">updateSurvivalProb</span>(simul_params, <span class="dt">mat_year=</span><span class="dv">1</span><span class="op">:</span>Nyears<span class="op">/</span><span class="dv">100</span>, <span class="dt">mat_croptype=</span><span class="dv">1</span><span class="op">:</span>Ncroptypes<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb33-95" title="95">simul_params<span class="op">@</span>Pathogen</a>
<a class="sourceLine" id="cb33-96" title="96"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb33-97" title="97"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb33-98" title="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-99" title="99"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb33-100" title="100"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb33-101" title="101"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-102" title="102"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb33-103" title="103"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb33-104" title="104"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-105" title="105"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb33-106" title="106"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb33-107" title="107"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-108" title="108"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb33-109" title="109"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb33-110" title="110"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-111" title="111"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb33-112" title="112"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb33-113" title="113"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-114" title="114"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb33-115" title="115"><span class="co">#&gt;  [1] 0.001 0.002 0.003 0.004 0.005 0.006 0.002 0.004 0.006 0.008 0.010 0.012</span></a>
<a class="sourceLine" id="cb33-116" title="116"><span class="co">#&gt; [13] 0.003 0.006 0.009 0.012 0.015 0.018 0.004 0.008 0.012 0.016 0.020 0.024</span></a>
<a class="sourceLine" id="cb33-117" title="117"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-118" title="118"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb33-119" title="119"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-120" title="120"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-121" title="121"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb33-122" title="122"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb33-123" title="123"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-124" title="124"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb33-125" title="125"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb33-126" title="126"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-127" title="127"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb33-128" title="128"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-129" title="129"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-130" title="130"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb33-131" title="131"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-132" title="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-133" title="133"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb33-134" title="134"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-135" title="135"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-136" title="136"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb33-137" title="137"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-138" title="138"><span class="co">## One probability per year and per croptype:</span></a>
<a class="sourceLine" id="cb33-139" title="139">simul_params &lt;-<span class="st"> </span><span class="kw">updateSurvivalProb</span>(simul_params, <span class="dt">mat=</span><span class="kw">matrix</span>(<span class="kw">runif</span>(Nyears<span class="op">*</span>Ncroptypes), <span class="dt">ncol=</span>Ncroptypes))</a>
<a class="sourceLine" id="cb33-140" title="140">simul_params<span class="op">@</span>Pathogen</a>
<a class="sourceLine" id="cb33-141" title="141"><span class="co">#&gt; $infection_rate</span></a>
<a class="sourceLine" id="cb33-142" title="142"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb33-143" title="143"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-144" title="144"><span class="co">#&gt; $latent_period_mean</span></a>
<a class="sourceLine" id="cb33-145" title="145"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb33-146" title="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-147" title="147"><span class="co">#&gt; $latent_period_var</span></a>
<a class="sourceLine" id="cb33-148" title="148"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb33-149" title="149"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-150" title="150"><span class="co">#&gt; $propagule_prod_rate</span></a>
<a class="sourceLine" id="cb33-151" title="151"><span class="co">#&gt; [1] 3.125</span></a>
<a class="sourceLine" id="cb33-152" title="152"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-153" title="153"><span class="co">#&gt; $infectious_period_mean</span></a>
<a class="sourceLine" id="cb33-154" title="154"><span class="co">#&gt; [1] 24</span></a>
<a class="sourceLine" id="cb33-155" title="155"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-156" title="156"><span class="co">#&gt; $infectious_period_var</span></a>
<a class="sourceLine" id="cb33-157" title="157"><span class="co">#&gt; [1] 105</span></a>
<a class="sourceLine" id="cb33-158" title="158"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-159" title="159"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb33-160" title="160"><span class="co">#&gt;  [1] 0.33532076 0.63790872 0.82920106 0.70897520 0.34855035 0.12832787</span></a>
<a class="sourceLine" id="cb33-161" title="161"><span class="co">#&gt;  [7] 0.38807849 0.92817755 0.80439077 0.75869681 0.95724989 0.99391388</span></a>
<a class="sourceLine" id="cb33-162" title="162"><span class="co">#&gt; [13] 0.60644099 0.02937717 0.33644536 0.27765809 0.11719755 0.04321826</span></a>
<a class="sourceLine" id="cb33-163" title="163"><span class="co">#&gt; [19] 0.37030979 0.33687831 0.17365255 0.62177328 0.39784363 0.95567577</span></a>
<a class="sourceLine" id="cb33-164" title="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-165" title="165"><span class="co">#&gt; $repro_sex_prob</span></a>
<a class="sourceLine" id="cb33-166" title="166"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-167" title="167"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-168" title="168"><span class="co">#&gt; $sigmoid_kappa</span></a>
<a class="sourceLine" id="cb33-169" title="169"><span class="co">#&gt; [1] 5.333</span></a>
<a class="sourceLine" id="cb33-170" title="170"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-171" title="171"><span class="co">#&gt; $sigmoid_sigma</span></a>
<a class="sourceLine" id="cb33-172" title="172"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb33-173" title="173"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-174" title="174"><span class="co">#&gt; $sigmoid_plateau</span></a>
<a class="sourceLine" id="cb33-175" title="175"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-176" title="176"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-177" title="177"><span class="co">#&gt; $sex_propagule_viability_limit</span></a>
<a class="sourceLine" id="cb33-178" title="178"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-179" title="179"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-180" title="180"><span class="co">#&gt; $sex_propagule_release_mean</span></a>
<a class="sourceLine" id="cb33-181" title="181"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb33-182" title="182"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-183" title="183"><span class="co">#&gt; $clonal_propagule_gradual_release</span></a>
<a class="sourceLine" id="cb33-184" title="184"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<div id="visualization-1" class="section level3">
<h3>Visualization</h3>
<p>The matrix of survival probabilities for every year and croptype, as well as for every polygon and year, can be vizualised using the function <code>survivalProbToMatrix()</code>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">survivalProbToMatrix</span>(simul_params)</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co">#&gt; $survival_prob</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co">#&gt;        Susceptible crop Pure resistant crop    Mixture     Other</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co">#&gt; year_1        0.3353208           0.3880785 0.60644099 0.3703098</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="co">#&gt; year_2        0.6379087           0.9281775 0.02937717 0.3368783</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co">#&gt; year_3        0.8292011           0.8043908 0.33644536 0.1736526</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="co">#&gt; year_4        0.7089752           0.7586968 0.27765809 0.6217733</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="co">#&gt; year_5        0.3485504           0.9572499 0.11719755 0.3978436</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="co">#&gt; year_6        0.1283279           0.9939139 0.04321826 0.9556758</span></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb34-11" title="11"><span class="co">#&gt; $survival_prob_poly</span></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="co">#&gt;             year_1    year_2    year_3    year_4    year_5    year_6</span></a>
<a class="sourceLine" id="cb34-13" title="13"><span class="co">#&gt; poly_1   0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-14" title="14"><span class="co">#&gt; poly_2   0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-15" title="15"><span class="co">#&gt; poly_3   0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-16" title="16"><span class="co">#&gt; poly_4   0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-17" title="17"><span class="co">#&gt; poly_5   0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-18" title="18"><span class="co">#&gt; poly_6   0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="co">#&gt; poly_7   0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-20" title="20"><span class="co">#&gt; poly_8   0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-21" title="21"><span class="co">#&gt; poly_9   0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-22" title="22"><span class="co">#&gt; poly_10  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-23" title="23"><span class="co">#&gt; poly_11  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-24" title="24"><span class="co">#&gt; poly_12  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-25" title="25"><span class="co">#&gt; poly_13  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-26" title="26"><span class="co">#&gt; poly_14  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-27" title="27"><span class="co">#&gt; poly_15  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-28" title="28"><span class="co">#&gt; poly_16  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-29" title="29"><span class="co">#&gt; poly_17  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-30" title="30"><span class="co">#&gt; poly_18  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-31" title="31"><span class="co">#&gt; poly_19  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-32" title="32"><span class="co">#&gt; poly_20  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-33" title="33"><span class="co">#&gt; poly_21  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-34" title="34"><span class="co">#&gt; poly_22  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-35" title="35"><span class="co">#&gt; poly_23  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-36" title="36"><span class="co">#&gt; poly_24  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-37" title="37"><span class="co">#&gt; poly_25  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-38" title="38"><span class="co">#&gt; poly_26  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-39" title="39"><span class="co">#&gt; poly_27  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-40" title="40"><span class="co">#&gt; poly_28  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-41" title="41"><span class="co">#&gt; poly_29  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-42" title="42"><span class="co">#&gt; poly_30  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-43" title="43"><span class="co">#&gt; poly_31  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-44" title="44"><span class="co">#&gt; poly_32  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-45" title="45"><span class="co">#&gt; poly_33  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-46" title="46"><span class="co">#&gt; poly_34  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-47" title="47"><span class="co">#&gt; poly_35  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-48" title="48"><span class="co">#&gt; poly_36  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-49" title="49"><span class="co">#&gt; poly_37  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-50" title="50"><span class="co">#&gt; poly_38  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-51" title="51"><span class="co">#&gt; poly_39  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-52" title="52"><span class="co">#&gt; poly_40  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-53" title="53"><span class="co">#&gt; poly_41  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-54" title="54"><span class="co">#&gt; poly_42  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-55" title="55"><span class="co">#&gt; poly_43  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-56" title="56"><span class="co">#&gt; poly_44  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-57" title="57"><span class="co">#&gt; poly_45  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-58" title="58"><span class="co">#&gt; poly_46  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-59" title="59"><span class="co">#&gt; poly_47  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-60" title="60"><span class="co">#&gt; poly_48  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-61" title="61"><span class="co">#&gt; poly_49  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-62" title="62"><span class="co">#&gt; poly_50  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-63" title="63"><span class="co">#&gt; poly_51  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-64" title="64"><span class="co">#&gt; poly_52  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-65" title="65"><span class="co">#&gt; poly_53  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-66" title="66"><span class="co">#&gt; poly_54  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-67" title="67"><span class="co">#&gt; poly_55  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-68" title="68"><span class="co">#&gt; poly_56  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-69" title="69"><span class="co">#&gt; poly_57  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-70" title="70"><span class="co">#&gt; poly_58  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-71" title="71"><span class="co">#&gt; poly_59  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-72" title="72"><span class="co">#&gt; poly_60  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-73" title="73"><span class="co">#&gt; poly_61  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-74" title="74"><span class="co">#&gt; poly_62  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-75" title="75"><span class="co">#&gt; poly_63  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-76" title="76"><span class="co">#&gt; poly_64  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-77" title="77"><span class="co">#&gt; poly_65  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-78" title="78"><span class="co">#&gt; poly_66  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-79" title="79"><span class="co">#&gt; poly_67  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-80" title="80"><span class="co">#&gt; poly_68  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-81" title="81"><span class="co">#&gt; poly_69  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-82" title="82"><span class="co">#&gt; poly_70  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-83" title="83"><span class="co">#&gt; poly_71  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-84" title="84"><span class="co">#&gt; poly_72  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-85" title="85"><span class="co">#&gt; poly_73  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-86" title="86"><span class="co">#&gt; poly_74  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-87" title="87"><span class="co">#&gt; poly_75  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-88" title="88"><span class="co">#&gt; poly_76  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-89" title="89"><span class="co">#&gt; poly_77  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-90" title="90"><span class="co">#&gt; poly_78  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-91" title="91"><span class="co">#&gt; poly_79  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-92" title="92"><span class="co">#&gt; poly_80  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-93" title="93"><span class="co">#&gt; poly_81  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-94" title="94"><span class="co">#&gt; poly_82  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-95" title="95"><span class="co">#&gt; poly_83  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-96" title="96"><span class="co">#&gt; poly_84  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-97" title="97"><span class="co">#&gt; poly_85  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-98" title="98"><span class="co">#&gt; poly_86  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-99" title="99"><span class="co">#&gt; poly_87  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-100" title="100"><span class="co">#&gt; poly_88  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-101" title="101"><span class="co">#&gt; poly_89  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-102" title="102"><span class="co">#&gt; poly_90  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-103" title="103"><span class="co">#&gt; poly_91  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-104" title="104"><span class="co">#&gt; poly_92  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-105" title="105"><span class="co">#&gt; poly_93  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-106" title="106"><span class="co">#&gt; poly_94  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-107" title="107"><span class="co">#&gt; poly_95  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-108" title="108"><span class="co">#&gt; poly_96  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-109" title="109"><span class="co">#&gt; poly_97  0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-110" title="110"><span class="co">#&gt; poly_98  0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-111" title="111"><span class="co">#&gt; poly_99  0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-112" title="112"><span class="co">#&gt; poly_100 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-113" title="113"><span class="co">#&gt; poly_101 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-114" title="114"><span class="co">#&gt; poly_102 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-115" title="115"><span class="co">#&gt; poly_103 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-116" title="116"><span class="co">#&gt; poly_104 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-117" title="117"><span class="co">#&gt; poly_105 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-118" title="118"><span class="co">#&gt; poly_106 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-119" title="119"><span class="co">#&gt; poly_107 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-120" title="120"><span class="co">#&gt; poly_108 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-121" title="121"><span class="co">#&gt; poly_109 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-122" title="122"><span class="co">#&gt; poly_110 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-123" title="123"><span class="co">#&gt; poly_111 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-124" title="124"><span class="co">#&gt; poly_112 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-125" title="125"><span class="co">#&gt; poly_113 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-126" title="126"><span class="co">#&gt; poly_114 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-127" title="127"><span class="co">#&gt; poly_115 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-128" title="128"><span class="co">#&gt; poly_116 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-129" title="129"><span class="co">#&gt; poly_117 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-130" title="130"><span class="co">#&gt; poly_118 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-131" title="131"><span class="co">#&gt; poly_119 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-132" title="132"><span class="co">#&gt; poly_120 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-133" title="133"><span class="co">#&gt; poly_121 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-134" title="134"><span class="co">#&gt; poly_122 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-135" title="135"><span class="co">#&gt; poly_123 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-136" title="136"><span class="co">#&gt; poly_124 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-137" title="137"><span class="co">#&gt; poly_125 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-138" title="138"><span class="co">#&gt; poly_126 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-139" title="139"><span class="co">#&gt; poly_127 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-140" title="140"><span class="co">#&gt; poly_128 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-141" title="141"><span class="co">#&gt; poly_129 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-142" title="142"><span class="co">#&gt; poly_130 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-143" title="143"><span class="co">#&gt; poly_131 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-144" title="144"><span class="co">#&gt; poly_132 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-145" title="145"><span class="co">#&gt; poly_133 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-146" title="146"><span class="co">#&gt; poly_134 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-147" title="147"><span class="co">#&gt; poly_135 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-148" title="148"><span class="co">#&gt; poly_136 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-149" title="149"><span class="co">#&gt; poly_137 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-150" title="150"><span class="co">#&gt; poly_138 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-151" title="151"><span class="co">#&gt; poly_139 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-152" title="152"><span class="co">#&gt; poly_140 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-153" title="153"><span class="co">#&gt; poly_141 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-154" title="154"><span class="co">#&gt; poly_142 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-155" title="155"><span class="co">#&gt; poly_143 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-156" title="156"><span class="co">#&gt; poly_144 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-157" title="157"><span class="co">#&gt; poly_145 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-158" title="158"><span class="co">#&gt; poly_146 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-159" title="159"><span class="co">#&gt; poly_147 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-160" title="160"><span class="co">#&gt; poly_148 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-161" title="161"><span class="co">#&gt; poly_149 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-162" title="162"><span class="co">#&gt; poly_150 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-163" title="163"><span class="co">#&gt; poly_151 0.3353208 0.6379087 0.8292011 0.7089752 0.3485504 0.1283279</span></a>
<a class="sourceLine" id="cb34-164" title="164"><span class="co">#&gt; poly_152 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-165" title="165"><span class="co">#&gt; poly_153 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a>
<a class="sourceLine" id="cb34-166" title="166"><span class="co">#&gt; poly_154 0.3703098 0.3368783 0.1736526 0.6217733 0.3978436 0.9556758</span></a>
<a class="sourceLine" id="cb34-167" title="167"><span class="co">#&gt; poly_155 0.3880785 0.9281775 0.3364454 0.2776581 0.9572499 0.9939139</span></a></code></pre></div>
</div>
</div>
<div id="setting-chemical-treatments" class="section level2">
<h2>Setting chemical treatments</h2>
<p>This part can be skipped if no chemical treatment is to be simulated.</p>
<p>Cultivars may be treated with chemicals which reduce the pathogen infection rate. Treatment efficiency is maximum (i.e. equal to the parameter <code>treatment_efficiency</code>) at the time of treatment application (noted <span class="math inline">\(t^*\)</span>); then it decreases with time (i.e. natural pesticide degradation) and host growth (i.e. new biomass is not protected by treatments):</p>
<p><span class="math display">\[IR(t) = IR_{max} \times  \left(1 - \frac{treatment\_efficiency}{1+e^{4.0- 8.5 \times C(t)}}\right)\]</span> <span class="math inline">\(C(t) = C_1 \times C_2\)</span> is the treatment concentration at <span class="math inline">\(t\)</span>, which depends on:</p>
<ul>
<li>the timelag <span class="math inline">\(\Delta t = t - t^*\)</span> passed since the time of treatment application <span class="math inline">\(t^*\)</span> (i.e. natural pesticide degradation via the parameter <code>treatment_degradation_rate</code>)</li>
</ul>
<p><span class="math display">\[C_1 = e^{-treatment\_degradation\_rate \times \Delta t}\]</span></p>
<ul>
<li>the newly produced host biomass, which is not protected by treatments (<span class="math inline">\(N(t^*)\)</span> and <span class="math inline">\(N(t)\)</span> are host biomass at the time of treatment application and at time <span class="math inline">\(t\)</span>, respectively)</li>
</ul>
<p><span class="math display">\[C_2 = min(1.0, N(t^*)/N(t))\]</span> Cultivars to be treated with chemicals and dates of (possible) applications are defined with parameters <code>treatment_cultivars</code> and <code>treatment_timesteps</code>, and are the same for all polygons cultivated with the cultivars to be treated. However, the chemicals are applied in a polygon only if the disease severity (i.e. <span class="math inline">\(I(t^*) / N(t^*)\)</span>) at the application date is higher than a given threshold, defined by <code>treatment_application_threshold</code>. The cost of a single treatment application (monetary units/ha) is defined by <code>treatment_cost</code> and will impact the economic outputs. Treatment parameters can be loaded via the function <code>loadTreatment</code> and next set via the function <code>setTreatment</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">## Via function loadTreatment:</span></a>
<a class="sourceLine" id="cb35-2" title="2">treatment &lt;-<span class="st"> </span><span class="kw">loadTreatment</span>(<span class="dt">disease=</span><span class="st">&quot;mildew&quot;</span>)</a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co">## Direct implementation:</span></a>
<a class="sourceLine" id="cb35-4" title="4">treatment &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">treatment_degradation_rate =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb35-5" title="5">                  <span class="dt">treatment_efficiency =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb35-6" title="6">                  <span class="dt">treatment_timesteps =</span>  <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">120</span>,<span class="dv">14</span>) ,</a>
<a class="sourceLine" id="cb35-7" title="7">                  <span class="dt">treatment_cultivars  =</span> <span class="kw">c</span>(<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb35-8" title="8">                  <span class="dt">treatment_cost =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb35-9" title="9">                  <span class="dt">treatment_application_threshold =</span> <span class="kw">c</span>(<span class="fl">0.0</span>))</a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">## Set the parameters</span></a>
<a class="sourceLine" id="cb35-11" title="11">simul_params &lt;-<span class="st"> </span><span class="kw">setTreatment</span>(simul_params, treatment)</a>
<a class="sourceLine" id="cb35-12" title="12"><span class="co">#&gt; Warning in checkTreatment(params): Simulation with chemical treatment</span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="co">#&gt; applications</span></a></code></pre></div>
</div>
<div id="choosing-output-variables" class="section level2">
<h2>Choosing output variables</h2>
<p>Several epidemiological, evolutionary and economic outputs can be generated by landsepi and represented in text files (<code>writeTXT=TRUE</code>), graphics (<code>graphic=TRUE</code>) and a video (<code>videoMP4=TRUE</code>).<br />
See equation below, as well as <code>?epid_output</code> and <code>?evol_output</code> for details on the different output variables.</p>
<blockquote>
<p>Possible epidemiological outputs include:<br />
- <strong>“audpc”</strong> : Area Under Disease Progress Curve (average number of diseased hosts per square meter, <span class="math inline">\(AUDPC_{v,y}\)</span>)<br />
- <strong>“audpc_rel”</strong> : relative Area Under Disease Progress Curve (average proportion of diseased hosts relative to the total number of existing hosts, <span class="math inline">\(AUDPC_{v,y}^r\)</span>)<br />
- <strong>“gla”</strong> : Green Leaf Area (average number of healthy hosts per square meter, <span class="math inline">\(GLA_{v,y}\)</span>)<br />
- <strong>“gla_rel”</strong> : relative Green Leaf Area (average proportion of healthy hosts relative to the total number of existing hosts, <span class="math inline">\(GLA_{v,y}^r\)</span>)<br />
- <strong>“eco_yield”</strong> : total crop yield (in weight or volume units per ha, <span class="math inline">\(Yield_{v,y}\)</span>)<br />
- <strong>“eco_cost”</strong> : operational crop costs (in monetary units per ha, <span class="math inline">\(Operational\_cost_{v,y}\)</span>)<br />
- <strong>“eco_product”</strong> : total crop products (in monetary units per ha, <span class="math inline">\(Product_{v,y}\)</span>)<br />
- <strong>“eco_margin”</strong> : margin (products - operational costs, in monetary units per ha, <span class="math inline">\(Margin_{v,y}\)</span>)<br />
- <strong>“contrib”</strong>: contribution of pathogen genotypes to LIR dynamics (<span class="math inline">\(Contrib_{p,v,y}\)</span>) - <strong>“HLIR_dynamics”, “H_dynamics”, “L_dynamics”, “IR_dynamics”, “HLI_dynamics”</strong>, etc.: Epidemic dynamics related to the specified sanitary status (H, L, I or R and all their combinations). Graphics only, works only if graphic=TRUE.<br />
- <strong>“all”</strong> : compute all these outputs (default)<br />
- <strong>&quot;&quot;</strong> : none of these outputs will be generated.</p>
</blockquote>
<blockquote>
<p>Possible evolutionary outputs, based on the computation of genotype frequencies (<span class="math inline">\(freq(I)_{p,t}\)</span>) include:<br />
- <strong>“evol_patho”</strong>: evolution of pathogen genotypes<br />
- <strong>“evol_aggr”</strong>: evolution of pathogen aggressiveness (i.e. phenotype)<br />
- <strong>“durability”</strong>: durability of resistance genes<br />
- <strong>“all”</strong>: compute all these outputs (default)<br />
- <strong>&quot;&quot;</strong>: none of these outputs will be generated.</p>
</blockquote>
<div id="equations" class="section level3">
<h3>Equations</h3>
<p>In the following equations, <span class="math inline">\(H_{i,v,t}\)</span>, <span class="math inline">\(L_{i,v,p,t}\)</span>, <span class="math inline">\(I_{i,v,p,t}\)</span> and <span class="math inline">\(R_{i,v,p,t}\)</span> respectively denote the number of healthy, latent, infectious and removed host individuals, respectively, in field <span class="math inline">\(i\)</span> (<span class="math inline">\(i=1,…,J\)</span>), for cultivar <span class="math inline">\(v\)</span> (<span class="math inline">\(v=1,…,V\)</span>) at time step <span class="math inline">\(t\)</span> (<span class="math inline">\(t=1,…,T \times Y\)</span> with <span class="math inline">\(Y\)</span> the total number of cropping seasons and <span class="math inline">\(T\)</span> the number of time-steps per season).</p>
<p><span class="math inline">\(AUDPC_{v,y} = \frac{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \sum_{p=1}^{P} \{I_{i,v,p,t}+R_{i,v,p,t}\}}{T \times \sum_{i=1}^{J} A_i}\)</span></p>
<p><span class="math inline">\(AUDPC^r_{v,y} = \frac{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \sum_{p=1}^{P} \{I_{i,v,p,t}+R_{i,v,p,t}\}}{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \left(H_{i,v,t}+\sum_{p=1}^{P} \{L_{i,v,p,t}+I_{i,v,p,t}+R_{i,v,p,t}\}\right)}\)</span></p>
<p><span class="math inline">\(GLA_{v,y} = \frac{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} H_{i,v,t}}{T \times \sum_{i=1}^{J} A_i}\)</span></p>
<p><span class="math inline">\(GLA^r_{v,y} = \frac{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} H_{i,v,t}}{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \left(H_{i,v,t}+\sum_{p=1}^{P} \{L_{i,v,p,t}+I_{i,v,p,t}+R_{i,v,p,t}\}\right)}\)</span></p>
<p><span class="math inline">\(Yield_{v,y} = \frac{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \left( y_{H,v} \times H_{i,v,t} + \sum_{p=1}^{P} \{y_{L,v} \times L_{i,v,p,t} + y_{I,v} \times I_{i,v,p,t} + y_{R,v} \times R_{i,v,p,t}\} \right)} {\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} H^*_{i,v,t}}\)</span> with <span class="math inline">\(y_{H,v}\)</span>, <span class="math inline">\(y_{L,v}\)</span>, <span class="math inline">\(y_{I,v}\)</span> and <span class="math inline">\(y_{R,v}\)</span> the theoretical yield of cultivar v in pure crop (in weight or volume unit/ha/season) associated with the sanitary statuses ‘H’, ‘L’, ‘I’ and ‘R’, respectively. <span class="math inline">\(H^*_{i,v,t}\)</span> is the number of healthy hosts in a pure crop and in absence of disease.</p>
<p><span class="math inline">\(Operational\_cost_{v,y}=planting\_cost_v \times \frac{\sum_{i \in \Omega_{v,y}}(area_i \times prop_{v,i})} {\sum_{i \in \Omega_{v,y}}area_i} + treatment\_cost \times \frac{\sum_{i \in \Omega_{v,y}}(TFI_{i,v,y} \times area_i \times prop_{v,i})} {\sum_{i \in \Omega_{v,y}}area_i}\)</span> with <span class="math inline">\(\Omega_{v,y}\)</span> the set of polygon indices where cultivar <span class="math inline">\(v\)</span> is cultivated at year <span class="math inline">\(y\)</span>, and <span class="math inline">\(prop_{v,i}\)</span> the proportion of cultivar <span class="math inline">\(v\)</span> in polygon <span class="math inline">\(i\)</span> (for mixtures). <span class="math inline">\(TFI\)</span> stands for the Treatment Frequency Indicator (number of treatment applications per ha).</p>
<p><span class="math inline">\(Product_{v,y}=yield_{v,y} \times market\_value\)</span></p>
<p><span class="math inline">\(Margin_{v,y} = Product_{v,y} - Operational\_Cost_{v,y}\)</span></p>
<p><span class="math inline">\(Contrib_{p,v,y} = \frac{\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \{L_{i,v,p,t}+I_{i,v,p,t}+R_{i,v,p,t}\}} {\sum_{t=t^0(y)}^{t^f(y)} \sum_{i=1}^{J} \sum_{p=1}^{P} \{L_{i,v,p,t}+I_{i,v,p,t}+R_{i,v,p,t}\}}\)</span></p>
<p><span class="math inline">\(freq(I)_{p,t} = \frac{\sum_{i=1}^{J} \sum_{v=1}^{V} I_{i,v,p,t}} {\sum_{p=1}^{P} \sum_{i=1}^{J} \sum_{v=1}^{V} I_{i,v,p,t}}\)</span></p>
<p>With respect to evolutionary outputs, for each pathogen genotype (<code>evol_patho</code>) or phenotype (<code>evol_aggr</code>, note that different pathogen genotypes may lead to the same phenotype on a resistant host, i.e. level of aggressiveness), several computations are performed:<br />
- appearance: time to first appearance (as propagule);<br />
- R_infection: time to first true infection of a resistant host;<br />
- R_invasion: time to invasion, when the number of infections of resistant hosts reaches <code>thres_breakdown</code>, above which the genotype or phenotype is unlikely to go extinct.<br />
The value <code>Nyears + 1 time step</code> is used if the genotype or phenotype never appeared/infected/invaded.<br />
Durability is defined as the time to invasion of completely adapted pathogen individuals.</p>
</div>
<div id="parameterisation" class="section level3">
<h3>Parameterisation</h3>
<p>A list of outputs can be generated using <code>loadOutputs()</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">outputlist &lt;-<span class="st"> </span><span class="kw">loadOutputs</span>(<span class="dt">epid_outputs =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">evol_outputs =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">disease=</span><span class="st">&quot;rust&quot;</span>)</a>
<a class="sourceLine" id="cb36-2" title="2">outputlist</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co">#&gt; $epid_outputs</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">#&gt; [1] &quot;all&quot;</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co">#&gt; $evol_outputs</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co">#&gt; [1] &quot;all&quot;</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co">#&gt; $thres_breakdown</span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="co">#&gt; [1] 50000</span></a>
<a class="sourceLine" id="cb36-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb36-12" title="12"><span class="co">#&gt; $audpc100S</span></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="co">#&gt; [1] 0.76</span></a></code></pre></div>
<p>Among the elements of <code>outputList</code>, “audpc100S” is the audpc in a fully susceptible landscape (used as reference value for graphics). If necessary, the function <code>compute_audpc100S</code> helps compute this value in a single 1-km^2 field:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">audpc100S &lt;-<span class="st"> </span><span class="kw">compute_audpc100S</span>(<span class="st">&quot;rust&quot;</span>, <span class="st">&quot;wheat&quot;</span>, <span class="dt">area=</span><span class="fl">1E6</span>)</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="co">#&gt; Computing audpc100S for rust in a single susceptible field of 1e+06 m^2 during 120 time steps</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="co">#&gt; [1] &quot;Run the C++ model&quot;</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="co">#&gt; *** SPATIOTEMPORAL MODEL SIMULATING THE SPREAD AND EVOLUTION OF A PATHOGEN IN A LANDSCAPE ***</span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-7" title="7"><span class="co">#&gt; ----------------------------- YEAR 1 -----------------------------</span></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="co">#&gt; ----------------------------- YEAR 2 -----------------------------</span></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="co">#&gt; ----------------------------- YEAR 3 -----------------------------</span></a>
<a class="sourceLine" id="cb37-10" title="10"><span class="co">#&gt; ----------------------------- YEAR 4 -----------------------------</span></a>
<a class="sourceLine" id="cb37-11" title="11"><span class="co">#&gt; ----------------------------- YEAR 5 -----------------------------</span></a>
<a class="sourceLine" id="cb37-12" title="12"><span class="co">#&gt; total computational time 0 seconds. </span></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="co">#&gt; [1] &quot;Compute model outputs&quot;</span></a>
<a class="sourceLine" id="cb37-14" title="14"><span class="co">#&gt; [1] &quot;remove binary files&quot;</span></a>
<a class="sourceLine" id="cb37-15" title="15"><span class="co">#&gt; [1] &quot;model outputs stored in : /tmp/RtmpTV3Uvw/Rbuild2f9604168c35a/landsepi/vignettes&quot;</span></a>
<a class="sourceLine" id="cb37-16" title="16">audpc100S &lt;-<span class="st"> </span><span class="kw">compute_audpc100S</span>(<span class="st">&quot;mildew&quot;</span>, <span class="st">&quot;grapevine&quot;</span>, <span class="dt">area=</span><span class="fl">1E6</span>)</a>
<a class="sourceLine" id="cb37-17" title="17"><span class="co">#&gt; Computing audpc100S for mildew in a single susceptible field of 1e+06 m^2 during 120 time steps</span></a>
<a class="sourceLine" id="cb37-18" title="18"><span class="co">#&gt; [1] &quot;Run the C++ model&quot;</span></a>
<a class="sourceLine" id="cb37-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-20" title="20"><span class="co">#&gt; *** SPATIOTEMPORAL MODEL SIMULATING THE SPREAD AND EVOLUTION OF A PATHOGEN IN A LANDSCAPE ***</span></a>
<a class="sourceLine" id="cb37-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-22" title="22"><span class="co">#&gt; ----------------------------- YEAR 1 -----------------------------</span></a>
<a class="sourceLine" id="cb37-23" title="23"><span class="co">#&gt; ----------------------------- YEAR 2 -----------------------------</span></a>
<a class="sourceLine" id="cb37-24" title="24"><span class="co">#&gt; ----------------------------- YEAR 3 -----------------------------</span></a>
<a class="sourceLine" id="cb37-25" title="25"><span class="co">#&gt; ----------------------------- YEAR 4 -----------------------------</span></a>
<a class="sourceLine" id="cb37-26" title="26"><span class="co">#&gt; ----------------------------- YEAR 5 -----------------------------</span></a>
<a class="sourceLine" id="cb37-27" title="27"><span class="co">#&gt; total computational time 3 seconds. </span></a>
<a class="sourceLine" id="cb37-28" title="28"><span class="co">#&gt; [1] &quot;Compute model outputs&quot;</span></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="co">#&gt; [1] &quot;remove binary files&quot;</span></a>
<a class="sourceLine" id="cb37-30" title="30"><span class="co">#&gt; [1] &quot;model outputs stored in : /tmp/RtmpTV3Uvw/Rbuild2f9604168c35a/landsepi/vignettes&quot;</span></a>
<a class="sourceLine" id="cb37-31" title="31">audpc100S &lt;-<span class="st"> </span><span class="kw">compute_audpc100S</span>(<span class="st">&quot;sigatoka&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="dt">area=</span><span class="fl">1E6</span>, <span class="dt">nTSpY=</span><span class="dv">182</span>)</a>
<a class="sourceLine" id="cb37-32" title="32"><span class="co">#&gt; Computing audpc100S for sigatoka in a single susceptible field of 1e+06 m^2 during 182 time steps</span></a>
<a class="sourceLine" id="cb37-33" title="33"><span class="co">#&gt; [1] &quot;Run the C++ model&quot;</span></a>
<a class="sourceLine" id="cb37-34" title="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-35" title="35"><span class="co">#&gt; *** SPATIOTEMPORAL MODEL SIMULATING THE SPREAD AND EVOLUTION OF A PATHOGEN IN A LANDSCAPE ***</span></a>
<a class="sourceLine" id="cb37-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-37" title="37"><span class="co">#&gt; ----------------------------- YEAR 1 -----------------------------</span></a>
<a class="sourceLine" id="cb37-38" title="38"><span class="co">#&gt; ----------------------------- YEAR 2 -----------------------------</span></a>
<a class="sourceLine" id="cb37-39" title="39"><span class="co">#&gt; ----------------------------- YEAR 3 -----------------------------</span></a>
<a class="sourceLine" id="cb37-40" title="40"><span class="co">#&gt; ----------------------------- YEAR 4 -----------------------------</span></a>
<a class="sourceLine" id="cb37-41" title="41"><span class="co">#&gt; ----------------------------- YEAR 5 -----------------------------</span></a>
<a class="sourceLine" id="cb37-42" title="42"><span class="co">#&gt; total computational time 0 seconds. </span></a>
<a class="sourceLine" id="cb37-43" title="43"><span class="co">#&gt; [1] &quot;Compute model outputs&quot;</span></a>
<a class="sourceLine" id="cb37-44" title="44"><span class="co">#&gt; [1] &quot;remove binary files&quot;</span></a>
<a class="sourceLine" id="cb37-45" title="45"><span class="co">#&gt; [1] &quot;model outputs stored in : /tmp/RtmpTV3Uvw/Rbuild2f9604168c35a/landsepi/vignettes&quot;</span></a></code></pre></div>
<p>Then <code>simul_params</code> can be updated via <code>setOutputs()</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">simul_params &lt;-<span class="st"> </span><span class="kw">setOutputs</span>(simul_params, outputlist)</a></code></pre></div>
<p><em>See also tutorial on how to <a href="O2-run_exp_design.html">run a numerical experimental design</a> to compute your own output variables and to run several simulations within an experimental design</em></p>
</div>
</div>
<div id="running-the-simulation" class="section level2">
<h2>Running the simulation</h2>
<p>The functions <code>checkSimulParams()</code> and <code>saveDeploymentStrategy()</code> check simulation parameters and save the object <code>simul_params</code> (which contains all parameters associated with the deployment strategy) into a GPKG file, respectively.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">checkSimulParams</span>(simul_params)</a>
<a class="sourceLine" id="cb39-2" title="2">simul_params &lt;-<span class="st"> </span><span class="kw">saveDeploymentStrategy</span>(simul_params)</a></code></pre></div>
<p>Then, the function <code>runSimul()</code> launches the simulation. Use <code>?runSimul</code> to get all available options.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">runSimul</span>(simul_params, <span class="dt">graphic =</span> <span class="ot">TRUE</span>, <span class="dt">videoMP4 =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
